---
title: 合规标准
weight: 300
draft: true
description: 主流国际与中国标准对数据库 RTO/RPO 的合规要求，以及 PostgreSQL 如何满足这些要求。
icon: fa-solid fa-scale-balanced
module: [PIGSTY, PGSQL]
categories: [概念]
---


## 概览

本文整理了主流国际与中国标准对数据库灾难恢复的 **RTO**（恢复时间目标）与 **RPO**（恢复点目标）合规要求。这些标准涵盖金融、医疗、支付、上市公司等关键行业，是数据库选型与架构设计的重要参考依据。

**核心结论**：PostgreSQL + Patroni 同步复制模式，配合合理的 `ttl`/`loop_wait` 参数，完全可以满足金融行业对核心系统 **RPO=0、RTO<2小时** 的要求。实际上，Pigsty 默认配置已能实现秒级 RTO，远超监管最低要求。


-----------

## 中国国家标准

[**《网络安全技术 信息系统灾难恢复规范》**](https://std.samr.gov.cn/)（GB/T 20988-2025）是中国信息系统灾难恢复的基础性国家标准，于 2025 年 6 月 30 日发布，2026 年 1 月 1 日起实施。该标准整合并替代了原 GB/T 20988-2007《信息安全技术 信息系统灾难恢复规范》和 GB/T 30285-2013《信息安全技术 灾难恢复中心建设与运维管理规范》。

新版标准引入了灾难恢复生命周期概念，更新了灾难恢复能力等级划分、RTO/RPO 与灾难恢复能力等级的关系示例、灾难恢复预案框架等内容，并新增了云技术灾难恢复服务示例。国标将灾难恢复能力划分为 **6 个等级**：

| 等级 | 名称          | RTO         | RPO      | 典型技术实现      |
|:---|:------------|:------------|:---------|:------------|
| 1级 | 基本支持        | > 7天        | 1天 ~ 7天  | 磁带异地保存      |
| 2级 | 备用场地支持      | > 24小时      | 1天 ~ 7天  | 冷备中心        |
| 3级 | 电子传输 + 部分设备 | 12小时 ~ 24小时 | 数小时 ~ 1天 | 异步复制 + 部分设备 |
| 4级 | 电子传输 + 完整设备 | 数小时 ~ 12小时  | 数小时      | 异步复制 + 完整设备 |
| 5级 | 实时传输 + 完整设备 | 数分钟 ~ 2小时   | 0 ~ 30分钟 | 同步复制 + 热备   |
| 6级 | 零丢失 + 远程集群  | 分钟级         | 0        | 同步复制 + 备用集群 |
{.full-width}

第 6 级要求客户数据得到实时同步更新，保证业务数据的一致性和完整性；备份中心的远程集群系统及网络系统可自动进行负载均衡和系统切换，业务恢复时间可控制在分钟级，实现数据零丢失。

**Pigsty 能力对照**：

| 配置                          | RTO        | RPO            | 对应国标等级 |
|:------------------------------|:-----------|:---------------|:-------------|
| 默认异步（`pg_rto=30`）       | ~30-40s    | 可能丢失 < 1MB | 5级          |
| 默认同步（`pg_rto=30`）       | ~30-35s    | 0              | 6级          |
| 激进同步（`pg_rto=15`）       | ~10-15s    | 0              | 6级          |
| 两地三中心 + 同步             | ~15-30s    | 0              | 6级          |
{.full-width}


-----------

## 中国金融行业标准

金融机构对数据零丢失和业务连续性要求在各行各业中**最为严格**，特别是银行和证券机构。银行架构要求采用 **两地三中心** 
或主备等多种模式构建灾备系统，同城数据中心应距离大于 50 公里，异地数据中心大于 300 公里。

| 行业   | 标准文件                                                                                                                                            | RTO                  | RPO                | 说明                                       |
|:-------|:----------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------|:-------------------|:-------------------------------------------|
| 银行   | [**《商业银行业务连续性监管指引》**](https://www.gov.cn/gzdt/2011-08/22/content_1930374.htm)（银监发〔2011〕104号）                                | ≤ 4小时              | ≤ 30分钟           | 重要业务系统的基本要求                     |
| 银行   | [**《银行业信息系统灾难恢复管理规范》**](https://www.cfstc.org/bzgk/gk/view/bzxq.jsp?i=bzid%3D5BEBABB4E5EE7918B86F6D56EDC9B78E62AF168D4B9EB4AE)（JR/T 0044-2008）                                                  | < 6小时 ~ < 24小时   | < 15分钟 ~ < 2小时 | 按系统重要性分级，关键系统要求更严格       |
| 银行   | [**《分布式数据库技术金融应用规范》**](http://www.caict.ac.cn/kxyj/qwfb/ztbg/202011/P020201116397348788498.pdf)（JR/T 0205-2020）                   | ≤ 30分钟 ~ ≤ 1分钟   | 0                  | 分布式数据库 4-6 级要求，RPO 均为零        |
| 证券   | [**《证券期货业信息系统备份能力标准》**](https://neris.csrc.gov.cn/falvfagui/rdqsHeader/mainbody?navbarId=3&secFutrsLawId=ac60afab583f475bb84bfd5fb3d0e7d7)（JR/T 0059-2021）                                     | ≤ 15分钟             | 0                  | 核心交易系统要求达到国标 5-6 级            |
| 保险   | [**《保险业信息系统灾难恢复管理指引》**](https://www.gov.cn/gzdt/2008-05/20/content_980596.htm)（保监发〔2008〕20号）                               | ≤ 36小时 ~ ≤ 72小时  | ≤ 8小时 ~ ≤ 24小时 | 按系统重要性分为 3-4 级，要求相对宽松      |
{.full-width}

根据金融行业标准，应用于金融领域的分布式事务数据库 **RPO 要求均为 0**。

### 金融行业 RTO/RPO 汇总

| 行业         | 系统类型           | RTO       | RPO       | 容灾等级 |
|:-------------|:-------------------|:----------|:----------|:---------|
| 银行-核心    | 核心银行、支付清算 | ≤ 2小时   | ≤ 15分钟  | 5-6级    |
| 银行-重要    | 网银、渠道系统     | ≤ 4小时   | ≤ 30分钟  | 4-5级    |
| 银行-一般    | 办公、报表         | ≤ 24小时  | ≤ 2小时   | 3-4级    |
| 证券-交易    | 撮合、清算         | ≤ 15分钟  | 0         | 6级      |
| 证券-一般    | 行情、资讯         | ≤ 4小时   | ≤ 1小时   | 4-5级    |
| 保险-核心    | 出单、理赔         | ≤ 36小时  | ≤ 8小时   | 4级      |
| 保险-重要    | 客服、财务         | ≤ 72小时  | ≤ 24小时  | 3级      |
{.full-width}


-----------

## 其他行业标准

灾备相关重点行业包括银行、电力、铁路、民航、证券、保险、海关、税务等八大行业。

| 行业               | 核心系统 RTO | 核心系统 RPO | 参考标准           |
|:-------------------|:-------------|:-------------|:-------------------|
| 电力/能源          | ≤ 4小时      | ≤ 1小时      | 电监会相关规定     |
| 电信               | ≤ 2小时      | ≤ 30分钟     | 工信部相关规定     |
| 医疗（三甲）       | ≤ 4小时      | ≤ 1小时      | 卫健委信息化要求   |
| 政务（省级）       | ≤ 4小时      | ≤ 2小时      | 网信办要求         |
| 交通（民航/铁路）  | ≤ 2小时      | ≤ 30分钟     | 民航局/铁总要求    |
| 电商/互联网        | ≤ 15分钟     | ≤ 5分钟      | 业务驱动           |
| 制造业             | ≤ 8小时      | ≤ 4小时      | 业务需求           |
| 教育               | ≤ 24小时     | ≤ 8小时      | 教育部要求         |
{.full-width}


-----------

## 国际标准

### SHARE 78 标准（7层模型）

SHARE 78 是由 IBM 用户组织 SHARE 在 1978 年提出的容灾能力分级标准，是国际上最早、最权威的容灾分级体系，也是中国 GB/T 20988 国标的重要参考来源。

| Tier   | 名称                 | RTO          | RPO         | 数据库技术实现                                  |
|:-------|:---------------------|:-------------|:------------|:------------------------------------------------|
| Tier 0 | 无异地备份           | 无保障       | 无保障      | 仅本地数据，无任何备份                          |
| Tier 1 | PTAM 物理介质转移    | 数天 ~ 数周  | 24小时+     | 磁带备份、人工运输到异地                        |
| Tier 2 | PTAM + 热备中心      | 24 ~ 72小时  | 24小时      | 异地冷备数据中心，需手动恢复                    |
| Tier 3 | 电子传输             | 12 ~ 24小时  | 1 ~ 4小时   | 异步复制（PostgreSQL async 模式）               |
| Tier 4 | 活动备份中心         | 4 ~ 12小时   | 分钟 ~ 1小时| 异步复制 + 热备服务器，可快速接管               |
| Tier 5 | 双活/两阶段提交      | 1 ~ 4小时    | 分钟级      | 同步复制（`synchronous_commit=on`）             |
| Tier 6 | 零数据丢失           | 分钟级       | 0           | 同步复制 + 自动故障检测（Patroni + sync）       |
| Tier 7 | 自动故障转移         | 秒级         | 0           | 同步复制 + 自动 Failover + 应用透明切换         |
{.full-width}

**PostgreSQL/Patroni 配置对照**：

| Tier    | PostgreSQL/Patroni 配置                                              | Oracle 等价方案                |
|:--------|:---------------------------------------------------------------------|:-------------------------------|
| Tier 3-4 | `synchronous_commit: off` + Streaming Replication                   | Data Guard Maximum Performance |
| Tier 5   | `synchronous_commit: remote_write`                                  | Data Guard Maximum Availability|
| Tier 6   | `synchronous_commit: on/remote_apply` + `synchronous_mode: true`    | Data Guard Maximum Protection  |
| Tier 7   | Tier 6 + Patroni 自动 Failover + 连接池                              | RAC + Data Guard               |
{.full-width}


### ISO 22301（业务连续性管理）

ISO 22301 是业务连续性管理系统（BCMS）的国际标准，ISO 22300 定义了相关术语。

#### 核心术语定义

| 术语   | ISO 定义                                       | 数据库含义                               |
|:-------|:-----------------------------------------------|:-----------------------------------------|
| RTO    | 灾难发生后，业务流程必须恢复的时间期限         | 数据库服务从中断到恢复可用的最大时间     |
| RPO    | 组织可接受的数据丢失量（以时间衡量）           | 数据库可容忍的最大数据丢失时间窗口       |
| MTPD   | 最大可容忍中断期                               | 业务完全无法运作的极限时间               |
| MBCO   | 最低业务连续性目标                             | 灾难期间必须维持的最小服务级别           |
{.full-width}

#### ISO 22301 对数据库的要求

- **业务影响分析（BIA）**：必须评估数据库中断对业务的影响
- **分级保护**：不同重要性的数据库应有不同的 RTO/RPO 目标
- **定期测试**：至少每年进行一次灾备演练
- **文档化**：所有恢复程序必须书面记录
- **持续改进**：根据测试结果不断优化恢复流程


### PCI-DSS（支付卡行业数据安全标准）

PCI-DSS 是支付卡行业的数据安全标准，对处理信用卡/借记卡数据的系统有严格要求。

#### 核心要求

| 要求编号 | 内容             | 数据库要求                                   |
|:---------|:-----------------|:---------------------------------------------|
| 9.5.1    | 异地安全备份     | 数据库备份必须存储在物理隔离的安全位置       |
| 12.10.1  | 事件响应计划     | 必须包含数据库恢复程序                       |
| 12.10.2  | 年度测试         | 每年至少测试一次数据库恢复流程               |
| 10.7     | 审计日志保留     | 数据库审计日志至少保留 1 年，3 个月在线可查  |
{.full-width}

#### 按系统分级的 RTO/RPO 建议

| 系统类型         | 建议 RTO   | 建议 RPO  | 理由                   |
|:-----------------|:-----------|:----------|:-----------------------|
| 支付交易数据库   | ≤ 15分钟   | 接近 0    | 交易数据不可丢失       |
| 持卡人数据存储   | ≤ 1小时    | ≤ 1分钟   | 敏感数据需高度保护     |
| 客户账户系统     | ≤ 2小时    | ≤ 1小时   | 影响客户体验           |
| 历史归档系统     | ≤ 24小时   | ≤ 24小时  | 非实时业务             |
{.full-width}


### SOX（萨班斯-奥克斯利法案）

SOX 是美国上市公司必须遵守的财务报告内部控制法规。

#### 核心要求

| 条款     | 内容                                   | 数据库要求                                   |
|:---------|:---------------------------------------|:---------------------------------------------|
| 第 404 条 | 管理层建立和维护足够的财务报告内部控制 | 数据库灾备纳入内部控制范围                   |
| 第 802 条 | 防止财务记录的伪造、销毁或篡改         | 数据库审计追踪、不可变备份                   |
| 第 103/105 条 | 关键文档保留不少于 7 年            | 数据库归档策略、长期备份保留                 |
{.full-width}

#### SOX 数据库合规要求

| 要求         | 内容                   | 数据库实现                             |
|:-------------|:-----------------------|:---------------------------------------|
| 数据保留     | 财务数据至少保留 7 年  | 数据库归档策略、长期备份保留           |
| 审计追踪     | 所有变更必须可追溯     | 启用数据库审计日志、WAL 归档           |
| 访问控制     | 限制未授权访问         | 数据库角色权限、行级安全               |
| 完整性保护   | 防止数据篡改           | 校验和、不可变备份                     |
| 灾难恢复     | 完整的 DR 计划         | 文档化的恢复流程、定期测试             |
{.full-width}

#### SOX RTO/RPO 建议

| 系统类型       | 建议 RTO  | 建议 RPO  | 说明                   |
|:---------------|:----------|:----------|:-----------------------|
| 总账系统       | ≤ 4小时   | ≤ 1小时   | 财务报告核心           |
| 应收/应付系统  | ≤ 8小时   | ≤ 4小时   | 日常运营关键           |
| 报表系统       | ≤ 24小时  | ≤ 8小时   | 可容忍较长恢复时间     |
| 审计日志数据库 | ≤ 2小时   | 0         | 审计数据不可丢失       |
{.full-width}


### HIPAA（美国医疗信息保护法）

HIPAA 是美国医疗行业保护患者健康信息（PHI）的法规。

#### HIPAA 安全规则必需实施项

| 要求类型               | 数据库要求                                     |
|:-----------------------|:-----------------------------------------------|
| 数据备份计划（必需）   | 定期备份 ePHI，可恢复的精确副本                |
| 灾难恢复计划（必需）   | 将 ePHI 恢复到原始状态的程序                   |
| 紧急模式操作计划（必需）| 灾难期间保护 PHI 的关键业务功能               |
| 应用和数据关键性分析（可选）| 识别最关键的数据库和应用                   |
| 测试和修订程序（可选） | 定期测试和修订应急计划                         |
{.full-width}

#### HIPAA 数据库 RTO/RPO 参考

| 系统类型               | 建议 RTO  | 建议 RPO  | 理由                   |
|:-----------------------|:----------|:----------|:-----------------------|
| 电子健康记录（EHR）    | ≤ 1小时   | 接近 0    | 急诊需即时访问         |
| 药房管理系统           | ≤ 2小时   | ≤ 15分钟  | 用药安全关键           |
| 实验室信息系统         | ≤ 4小时   | ≤ 30分钟  | 诊断结果重要           |
| 计费系统               | ≤ 24小时  | ≤ 4小时   | 非临床系统             |
| 患者门户               | ≤ 8小时   | ≤ 1小时   | 影响患者体验           |
{.full-width}


### Basel III（巴塞尔协议III）

Basel III 是国际银行业监管的核心框架，由巴塞尔银行监管委员会制定。

#### 核心框架

巴塞尔委员会要求银行加强应对操作风险的能力，包括大流行病、网络事件、技术故障和自然灾害等可能导致重大运营故障的事件。银行应制定计划并实施控制措施，在网络事件发生时维护关键信息的完整性，例如在不可变介质上对支持关键操作的数据进行安全存储和离线备份。

#### Basel 对银行数据库的要求

银行的 ICT 政策应完整记录，包括：

- 治理和监督责任、风险所有权
- 当前实施的任何 ICT 安全措施
- 网络安全控制、事件响应计划
- 业务连续性和灾难恢复计划应定期审查和监控
- 必须识别关键 ICT 资产，根据对银行关键操作最重要的资产定制安全措施
- 包括在发生网络安全风险事件时保护关键数据的计划

#### Basel 银行业 RTO/RPO 建议

| 系统类型       | 建议 RTO   | 建议 RPO  | Basel 关注点           |
|:---------------|:-----------|:----------|:-----------------------|
| 核心银行系统   | ≤ 15分钟   | 0         | 系统重要性             |
| 支付清算系统   | ≤ 15分钟   | 0         | 金融基础设施           |
| 网上银行       | ≤ 30分钟   | ≤ 1分钟   | 客户服务连续性         |
| 风险管理系统   | ≤ 2小时    | ≤ 15分钟  | 监管报告               |
| 反洗钱系统     | ≤ 4小时    | ≤ 1小时   | 合规要求               |
{.full-width}


-----------

## 标准综合对比

### 各标准 RTO/RPO 要求对比

| 标准            | 适用行业   | 核心系统 RTO | 核心系统 RPO | 测试要求   | 数据保留 |
|:----------------|:-----------|:-------------|:-------------|:-----------|:---------|
| SHARE 78 Tier 6-7 | 通用     | 秒 ~ 分钟    | 0            | 建议定期   | 无规定   |
| ISO 22301       | 通用       | 按 BIA 定义  | 按 BIA 定义  | 至少年度   | 无规定   |
| PCI-DSS         | 支付       | ≤ 15分钟     | 接近 0       | 年度必需   | 1年+     |
| SOX             | 上市公司   | ≤ 4小时      | ≤ 1小时      | 定期必需   | 7年      |
| HIPAA           | 医疗       | ≤ 1小时      | ≤ 15分钟     | 定期必需   | 6年      |
| Basel III       | 银行       | ≤ 15分钟     | 0            | 定期必需   | 3-7年    |
{.full-width}

### PostgreSQL/Patroni 能力覆盖

| 合规要求             | Patroni 默认配置       | Patroni 优化配置       | 是否满足           |
|:---------------------|:-----------------------|:-----------------------|:-------------------|
| PCI-DSS 核心交易     | RTO~35s, RPO 可能丢失  | RTO~15s, RPO=0 (同步)  | ✅ 优化后满足       |
| SOX 财务系统         | ✅                      | ✅                      | ✅ 默认即满足       |
| HIPAA EHR            | ✅                      | ✅                      | ✅ 默认即满足       |
| Basel III 核心银行   | 需配置同步             | RTO~15s, RPO=0         | ✅ 优化后满足       |
| SHARE 78 Tier 7      | Tier 6                 | Tier 6-7               | ✅ 配合连接池可达   |
{.full-width}


-----------

## 配置建议

### 标准合规配置（SOX/HIPAA 一般系统）

```yaml
pg_rto: 30                            # 标准 TTL
pg_rpo: 1048576                       # 允许 1MB 数据丢失

# 对应 Patroni 配置
bootstrap:
  dcs:
    ttl: 30
    loop_wait: 10
    retry_timeout: 10
    synchronous_mode: false           # 异步复制
    # RTO: ~30-40s, RPO: 可能丢失数秒数据
```


### 严格合规配置（PCI-DSS/Basel III 核心系统）

```yaml
pg_rto: 15                            # 更短的 TTL
pg_rpo: 0                             # 零数据丢失
pg_conf: crit.yml                     # 使用关键业务模板

# 对应 Patroni 配置
bootstrap:
  dcs:
    ttl: 20
    loop_wait: 5
    retry_timeout: 5
    primary_start_timeout: 0
    synchronous_mode: true            # 同步复制
    synchronous_mode_strict: true     # 严格模式
    synchronous_node_count: 1
    # RTO: ~10-15s, RPO: 0
```


-----------

## 关键结论

1. **金融行业最严格**：Basel III 和 PCI-DSS 对核心交易系统要求 RPO=0、RTO<15分钟
2. **医疗行业注重可用性**：HIPAA 要求 ePHI 数据必须随时可访问，但 RPO 要求相对宽松
3. **SOX 重在数据完整性**：7年数据保留、完整审计追踪是核心要求
4. **PostgreSQL + Patroni 完全胜任**：
   - 同步复制模式可实现 **RPO=0**
   - 自动 Failover 可实现 **RTO<30秒**
   - 远超大多数合规标准的最低要求
5. **测试是共同要求**：所有标准都要求定期进行灾备演练和文档化

