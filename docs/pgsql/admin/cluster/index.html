<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>管理 PostgreSQL 数据库集群 | PIGSTY</title><meta name=description content="创建/销毁 PostgreSQL 集群，以及对现有集群进行扩容，缩容，克隆集群。"><meta property="og:url" content="https://pigsty.cc/docs/pgsql/admin/cluster/"><meta property="og:site_name" content="PIGSTY"><meta property="og:title" content="管理 PostgreSQL 数据库集群"><meta property="og:description" content="创建/销毁 PostgreSQL 集群，以及对现有集群进行扩容，缩容，克隆集群。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2026-02-08T16:14:56+08:00"><meta itemprop=name content="管理 PostgreSQL 数据库集群"><meta itemprop=description content="创建/销毁 PostgreSQL 集群，以及对现有集群进行扩容，缩容，克隆集群。"><meta itemprop=dateModified content="2026-02-08T16:14:56+08:00"><meta itemprop=wordCount content="1006"><meta itemprop=keywords content="任务,PGSQL"><meta name=twitter:card content="summary"><meta name=twitter:title content="管理 PostgreSQL 数据库集群"><meta name=twitter:description content="创建/销毁 PostgreSQL 集群，以及对现有集群进行扩容，缩容，克隆集群。"><link rel=preload href=/scss/main.min.3858138289ee11ec3386acfac6cdb648f958d81bdf477441fa83b86e29a55a1b.css as=style integrity="sha256-OFgTgonuEewzhqz6xs22SPlY2BvfR3RB+oO4bimlWhs=" crossorigin=anonymous><link href=/scss/main.min.3858138289ee11ec3386acfac6cdb648f958d81bdf477441fa83b86e29a55a1b.css rel=stylesheet integrity="sha256-OFgTgonuEewzhqz6xs22SPlY2BvfR3RB+oO4bimlWhs=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-LG1V9WTKGE"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LG1V9WTKGE")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 24 24" width="24" height="24"><defs/><g id="32" fill="none" stroke-dasharray="none" fill-opacity="1" stroke-opacity="1" stroke="none"><title>32</title><g id="32_图层_2"><title>图层 2</title><g id="Group_17"><g id="Graphic_16"/><g id="Graphic_15"><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#bbb" fill-opacity=".9526367"/><path d="M7.666187 11.971335l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_14"><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" fill="#de372c" fill-opacity=".8545852"/><path d="M7.666187 19.474806l2.165064-3.75H14.16138l2.165065 3.75-2.165065 3.75H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_13"><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" fill="#424242" fill-opacity=".9016462"/><path d="M14.161476 15.751202l2.165064-3.75h4.33013l2.165064 3.75-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_12"><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" fill="#ffa269" fill-opacity=".8975772"/><path d="M14.161476 8.226008 16.32654 4.4760076h4.33013L22.821734 8.226008l-2.165064 3.75H16.32654z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_11"><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" fill="#419edb" fill-opacity=".8979957"/><path d="M7.666187 4.5 9.831251.75H14.16138L16.326445 4.5 14.16138 8.25H9.831251z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_10"><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" fill="#2f6793" fill-opacity=".9002511"/><path d="M1.1491742 8.226008 3.3142388 4.4760076H7.644368L9.809432 8.226008l-2.165064 3.75H3.3142388z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g><g id="Graphic_9"><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" fill="#53ac79" fill-opacity=".9"/><path d="M1.182071 15.741036l2.1650645-3.75h4.330129l2.1650645 3.75-2.1650645 3.75H3.3471355z" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6730434"/></g></g></g></g></svg></span><span class=navbar-brand__name>PIGSTY</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docs/><i class='fa-solid fa-book'></i><span>文档</span></a></li><li class=nav-item><a class=nav-link href=/blog/><i class="fas fa-blog"></i><span>博客</span></a></li><li class="nav-item dropdown d-none d-lg-block td-navbar__version-menu"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>版本</a><ul class=dropdown-menu><li><a class=dropdown-item href=https://pigsty.io>Pigsty English Site</a></li><li><a class=dropdown-item href=https://doc.pgsty.com/zh>Pigsty v3.7 文档</a></li><li><a class=dropdown-item href=https://v34.pigsty.cc/zh>Pigsty v3.4 文档</a></li><li><a class=dropdown-item href=https://v27.pigsty.cc>Pigsty v2.7 文档</a></li><li><a class=dropdown-item href=https://v15.pigsty.cc/docs>Pigsty v1.5 文档</a></li></ul></div></li><li class=nav-item><a class=nav-link href=https://pgext.cloud target=_blank rel=noopener><i class='fa-solid fa-puzzle-piece'></i><span>扩展</span></a></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li><li class=nav-item><a class=nav-link href=# onclick="return switchLang(),!1" title="Switch to English / 切换语言"><i class="fas fa-language"></i></a></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder=站内搜索…… aria-label=站内搜索…… autocomplete=off data-offline-search-index-json-src=/offline-search-index.83c025000675b1802d158b8a9cff5b2a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav><script>function switchLang(){var t=window.location.host,e=window.location.pathname+window.location.search+window.location.hash;t.indexOf("pigsty.cc")!==-1?window.location.href="https://pigsty.io"+e:t.indexOf("pigsty.io")!==-1?window.location.href="https://pigsty.cc"+e:window.location.href="https://pigsty.io"+e}</script></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder=站内搜索…… aria-label=站内搜索…… autocomplete=off data-offline-search-index-json-src=/offline-search-index.83c025000675b1802d158b8a9cff5b2a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav data-sidebar-root-id=/docs/pgsql/><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docspgsql-li><a href=/docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docspgsql><i class="fas fa-database fa-bounce"></i><span class=td-sidebar-root-up-icon>模块：PGSQL</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child sidebar-divider" id=m-docspgsql_div_concept-li><input type=checkbox id=m-docspgsql_div_concept-check>
<label for=m-docspgsql_div_concept-check><span class="align-left ps-0 td-sidebar-link td-sidebar-link__divider" id=m-docspgsql_div_concept><span>配置指南</span></span></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqlconfig-li><input type=checkbox id=m-docspgsqlconfig-check>
<label for=m-docspgsqlconfig-check><a href=/docs/pgsql/config/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlconfig><i class="fa-solid fa-code"></i><span>集群配置</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigcluster-li><input type=checkbox id=m-docspgsqlconfigcluster-check>
<label for=m-docspgsqlconfigcluster-check><a href=/docs/pgsql/config/cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigcluster><i class="fa-solid fa-code"></i><span>集群实例</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigkernel-li><input type=checkbox id=m-docspgsqlconfigkernel-check>
<label for=m-docspgsqlconfigkernel-check><a href=/docs/pgsql/config/kernel/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigkernel><i class="fa-solid fa-microchip"></i><span>内核版本</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigalias-li><input type=checkbox id=m-docspgsqlconfigalias-check>
<label for=m-docspgsqlconfigalias-check><a href=/docs/pgsql/config/alias/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigalias><i class="fa-solid fa-square-binary"></i><span>别名翻译</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfiguser-li><input type=checkbox id=m-docspgsqlconfiguser-check>
<label for=m-docspgsqlconfiguser-check><a href=/docs/pgsql/config/user/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfiguser><i class="fa-solid fa-users"></i><span>用户/角色</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigdb-li><input type=checkbox id=m-docspgsqlconfigdb-check>
<label for=m-docspgsqlconfigdb-check><a href=/docs/pgsql/config/db/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigdb><i class="fa-solid fa-coins"></i><span>数据库</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfighba-li><input type=checkbox id=m-docspgsqlconfighba-check>
<label for=m-docspgsqlconfighba-check><a href=/docs/pgsql/config/hba/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfighba><i class="fa-solid fa-key"></i><span>HBA 规则</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigparam-li><input type=checkbox id=m-docspgsqlconfigparam-check>
<label for=m-docspgsqlconfigparam-check><a href=/docs/pgsql/config/param/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigparam><i class="fa-solid fa-sliders"></i><span>参数配置</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlconfigacl-li><input type=checkbox id=m-docspgsqlconfigacl-check>
<label for=m-docspgsqlconfigacl-check><a href=/docs/pgsql/config/acl/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlconfigacl><i class="fa-solid fa-lock"></i><span>访问控制</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlservice-li><input type=checkbox id=m-docspgsqlservice-check>
<label for=m-docspgsqlservice-check><a href=/docs/pgsql/service/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlservice><i class="fa-solid fa-arrow-down-up-across-line"></i><span>服务/接入</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlsecurity-li><input type=checkbox id=m-docspgsqlsecurity-check>
<label for=m-docspgsqlsecurity-check><a href=/docs/pgsql/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlsecurity><i class="fa-solid fa-lock"></i><span>访问控制</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child sidebar-divider" id=m-docspgsql_div_admin-li><input type=checkbox id=m-docspgsql_div_admin-check>
<label for=m-docspgsql_div_admin-check><span class="align-left ps-0 td-sidebar-link td-sidebar-link__divider" id=m-docspgsql_div_admin><span>管理任务</span></span></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docspgsqladmin-li><input type=checkbox id=m-docspgsqladmin-check checked>
<label for=m-docspgsqladmin-check><a href=/docs/pgsql/admin/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqladmin><i class="fa-solid fa-building-columns"></i><span>日常管理</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docspgsqladmincluster-li><input type=checkbox id=m-docspgsqladmincluster-check checked>
<label for=m-docspgsqladmincluster-check><a href=/docs/pgsql/admin/cluster/ title="管理 PostgreSQL 数据库集群" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docspgsqladmincluster><i class="fa-solid fa-server"></i><span class=td-sidebar-nav-active-item>集群管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladminuser-li><input type=checkbox id=m-docspgsqladminuser-check>
<label for=m-docspgsqladminuser-check><a href=/docs/pgsql/admin/user/ title="管理 PostgreSQL 业务用户" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladminuser><i class="fa-solid fa-users"></i><span>用户管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladmindb-li><input type=checkbox id=m-docspgsqladmindb-check>
<label for=m-docspgsqladmindb-check><a href=/docs/pgsql/admin/db/ title="管理 PostgreSQL 业务数据库" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladmindb><i class="fa-solid fa-coins"></i><span>数据库管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladminpatroni-li><input type=checkbox id=m-docspgsqladminpatroni-check>
<label for=m-docspgsqladminpatroni-check><a href=/docs/pgsql/admin/patroni/ title="管理 Patroni 高可用" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladminpatroni><i class="fa-solid fa-infinity"></i><span>高可用管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladminpgbouncer-li><input type=checkbox id=m-docspgsqladminpgbouncer-check>
<label for=m-docspgsqladminpgbouncer-check><a href=/docs/pgsql/admin/pgbouncer/ title="Pgbouncer 连接池管理" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladminpgbouncer><i class="fa-solid fa-filter"></i><span>连接池管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladmincomponent-li><input type=checkbox id=m-docspgsqladmincomponent-check>
<label for=m-docspgsqladmincomponent-check><a href=/docs/pgsql/admin/component/ title="管理 PostgreSQL 组件服务" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladmincomponent><i class="fa-solid fa-gears"></i><span>组件管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladmincrontab-li><input type=checkbox id=m-docspgsqladmincrontab-check>
<label for=m-docspgsqladmincrontab-check><a href=/docs/pgsql/admin/crontab/ title="管理 PostgreSQL 定时任务" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladmincrontab><i class="fa-solid fa-clock-rotate-left"></i><span>任务管理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladminupgrade-li><input type=checkbox id=m-docspgsqladminupgrade-check>
<label for=m-docspgsqladminupgrade-check><a href=/docs/pgsql/admin/upgrade/ title="升级 PostgreSQL 大小版本" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladminupgrade><i class="fa-solid fa-plane-up"></i><span>版本升级</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqladminext-li><input type=checkbox id=m-docspgsqladminext-check>
<label for=m-docspgsqladminext-check><a href=/docs/pgsql/admin/ext/ title="管理 PostgreSQL 扩展插件" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqladminext><i class="fas fa-puzzle-piece"></i><span>扩展管理</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqlbackup-li><input type=checkbox id=m-docspgsqlbackup-check>
<label for=m-docspgsqlbackup-check><a href=/docs/pgsql/backup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlbackup><i class="fa-solid fa-clock-rotate-left"></i><span>备份恢复</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackuppolicy-li><input type=checkbox id=m-docspgsqlbackuppolicy-check>
<label for=m-docspgsqlbackuppolicy-check><a href=/docs/pgsql/backup/policy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackuppolicy><i class="fa-solid fa-clipboard-list"></i><span>备份策略</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackupmechanism-li><input type=checkbox id=m-docspgsqlbackupmechanism-check>
<label for=m-docspgsqlbackupmechanism-check><a href=/docs/pgsql/backup/mechanism/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackupmechanism><i class="fa-solid fa-gears"></i><span>备份机制</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackuprepository-li><input type=checkbox id=m-docspgsqlbackuprepository-check>
<label for=m-docspgsqlbackuprepository-check><a href=/docs/pgsql/backup/repository/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackuprepository><i class="fa-solid fa-box-archive"></i><span>备份仓库</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackupadmin-li><input type=checkbox id=m-docspgsqlbackupadmin-check>
<label for=m-docspgsqlbackupadmin-check><a href=/docs/pgsql/backup/admin/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackupadmin><i class="fa-solid fa-terminal"></i><span>管理命令</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackuprestore-li><input type=checkbox id=m-docspgsqlbackuprestore-check>
<label for=m-docspgsqlbackuprestore-check><a href=/docs/pgsql/backup/restore/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackuprestore><i class="fa-solid fa-rotate-left"></i><span>恢复操作</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlbackupcluster-li><input type=checkbox id=m-docspgsqlbackupcluster-check>
<label for=m-docspgsqlbackupcluster-check><a href=/docs/pgsql/backup/cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlbackupcluster><i class="fa-solid fa-rotate-left"></i><span>克隆数据库集群</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlmigration-li><input type=checkbox id=m-docspgsqlmigration-check>
<label for=m-docspgsqlmigration-check><a href=/docs/pgsql/migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlmigration><i class="fa-solid fa-truck-moving"></i><span>数据迁移</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqltutorial-li><input type=checkbox id=m-docspgsqltutorial-check>
<label for=m-docspgsqltutorial-check><a href=/docs/pgsql/tutorial/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqltutorial><i class="fas fa-tasks"></i><span>任务教程</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialfailure-li><input type=checkbox id=m-docspgsqltutorialfailure-check>
<label for=m-docspgsqltutorialfailure-check><a href=/docs/pgsql/tutorial/failure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialfailure><i class="fa-solid fa-fire"></i><span>故障排查</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialdrop-li><input type=checkbox id=m-docspgsqltutorialdrop-check>
<label for=m-docspgsqltutorialdrop-check><a href=/docs/pgsql/tutorial/drop/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialdrop><i class="fa-solid fa-trash"></i><span>误删处理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialpitr-li><input type=checkbox id=m-docspgsqltutorialpitr-check>
<label for=m-docspgsqltutorialpitr-check><a href=/docs/pgsql/tutorial/pitr/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialpitr><i class="fa-solid fa-flask"></i><span>手工恢复</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialpg-fork-li><input type=checkbox id=m-docspgsqltutorialpg-fork-check>
<label for=m-docspgsqltutorialpg-fork-check><a href=/docs/pgsql/tutorial/pg-fork/ title="利用 xfs 实现实例 Fork" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialpg-fork><i class="fa-solid fa-code-fork"></i><span>Fork 实例</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialhugepage-li><input type=checkbox id=m-docspgsqltutorialhugepage-check>
<label for=m-docspgsqltutorialhugepage-check><a href=/docs/pgsql/tutorial/hugepage/ title="为 PostgreSQL 集群启用 HugePage" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialhugepage><i class="fa-solid fa-file-circle-plus"></i><span>启用大页支持</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialdrill-li><input type=checkbox id=m-docspgsqltutorialdrill-check>
<label for=m-docspgsqltutorialdrill-check><a href=/docs/pgsql/tutorial/drill/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialdrill><i class="fa-solid fa-arrow-right-from-bracket"></i><span>3坏2应急处理</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialpg-vip-li><input type=checkbox id=m-docspgsqltutorialpg-vip-check>
<label for=m-docspgsqltutorialpg-vip-check><a href=/docs/pgsql/tutorial/pg-vip/ title="使用 VIP-Manager 为 PostgreSQL 集群配置二层 VIP" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialpg-vip><i class="fa-solid fa-arrows-split-up-and-left"></i><span>配置 PG VIP</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltutorialcitus-li><input type=checkbox id=m-docspgsqltutorialcitus-check>
<label for=m-docspgsqltutorialcitus-check><a href=/docs/pgsql/tutorial/citus/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltutorialcitus><i class="fa-solid fa-hexagon-nodes"></i><span>Citus 集群部署</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child sidebar-divider" id=m-docspgsql_div_reference-li><input type=checkbox id=m-docspgsql_div_reference-check>
<label for=m-docspgsql_div_reference-check><span class="align-left ps-0 td-sidebar-link td-sidebar-link__divider" id=m-docspgsql_div_reference><span>参考资料</span></span></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlmonitor-li><input type=checkbox id=m-docspgsqlmonitor-check>
<label for=m-docspgsqlmonitor-check><a href=/docs/pgsql/monitor/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlmonitor><i class="fa-solid fa-binoculars"></i><span>监控系统</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqldashboard-li><input type=checkbox id=m-docspgsqldashboard-check>
<label for=m-docspgsqldashboard-check><a href=/docs/pgsql/dashboard/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqldashboard><i class="fa-solid fa-gauge-simple-high"></i><span>监控面板</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqldashboardoverview-li><input type=checkbox id=m-docspgsqldashboardoverview-check>
<label for=m-docspgsqldashboardoverview-check><a href=/docs/pgsql/dashboard/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqldashboardoverview><span>总览面板</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardoverviewpgsql-overview-li><input type=checkbox id=m-docspgsqldashboardoverviewpgsql-overview-check>
<label for=m-docspgsqldashboardoverviewpgsql-overview-check><a href=/docs/pgsql/dashboard/overview/pgsql-overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardoverviewpgsql-overview><span>PGSQL Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardoverviewpgsql-alert-li><input type=checkbox id=m-docspgsqldashboardoverviewpgsql-alert-check>
<label for=m-docspgsqldashboardoverviewpgsql-alert-check><a href=/docs/pgsql/dashboard/overview/pgsql-alert/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardoverviewpgsql-alert><span>PGSQL Alert</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardoverviewpgsql-shard-li><input type=checkbox id=m-docspgsqldashboardoverviewpgsql-shard-check>
<label for=m-docspgsqldashboardoverviewpgsql-shard-check><a href=/docs/pgsql/dashboard/overview/pgsql-shard/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardoverviewpgsql-shard><span>PGSQL Shard</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqldashboardcluster-li><input type=checkbox id=m-docspgsqldashboardcluster-check>
<label for=m-docspgsqldashboardcluster-check><a href=/docs/pgsql/dashboard/cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqldashboardcluster><span>集群面板</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-cluster-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-cluster-check>
<label for=m-docspgsqldashboardclusterpgsql-cluster-check><a href=/docs/pgsql/dashboard/cluster/pgsql-cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-cluster><span>PGSQL Cluster</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgrds-cluster-li><input type=checkbox id=m-docspgsqldashboardclusterpgrds-cluster-check>
<label for=m-docspgsqldashboardclusterpgrds-cluster-check><a href=/docs/pgsql/dashboard/cluster/pgrds-cluster/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgrds-cluster><span>PGRDS Cluster</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-activity-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-activity-check>
<label for=m-docspgsqldashboardclusterpgsql-activity-check><a href=/docs/pgsql/dashboard/cluster/pgsql-activity/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-activity><span>PGSQL Activity</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-replication-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-replication-check>
<label for=m-docspgsqldashboardclusterpgsql-replication-check><a href=/docs/pgsql/dashboard/cluster/pgsql-replication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-replication><span>PGSQL Replication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-service-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-service-check>
<label for=m-docspgsqldashboardclusterpgsql-service-check><a href=/docs/pgsql/dashboard/cluster/pgsql-service/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-service><span>PGSQL Service</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-databases-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-databases-check>
<label for=m-docspgsqldashboardclusterpgsql-databases-check><a href=/docs/pgsql/dashboard/cluster/pgsql-databases/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-databases><span>PGSQL Databases</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-patroni-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-patroni-check>
<label for=m-docspgsqldashboardclusterpgsql-patroni-check><a href=/docs/pgsql/dashboard/cluster/pgsql-patroni/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-patroni><span>PGSQL Patroni</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardclusterpgsql-pitr-li><input type=checkbox id=m-docspgsqldashboardclusterpgsql-pitr-check>
<label for=m-docspgsqldashboardclusterpgsql-pitr-check><a href=/docs/pgsql/dashboard/cluster/pgsql-pitr/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardclusterpgsql-pitr><span>PGSQL PITR</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqldashboardinstance-li><input type=checkbox id=m-docspgsqldashboardinstance-check>
<label for=m-docspgsqldashboardinstance-check><a href=/docs/pgsql/dashboard/instance/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqldashboardinstance><span>实例面板</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-instance-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-instance-check>
<label for=m-docspgsqldashboardinstancepgsql-instance-check><a href=/docs/pgsql/dashboard/instance/pgsql-instance/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-instance><span>PGSQL Instance</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgrds-instance-li><input type=checkbox id=m-docspgsqldashboardinstancepgrds-instance-check>
<label for=m-docspgsqldashboardinstancepgrds-instance-check><a href=/docs/pgsql/dashboard/instance/pgrds-instance/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgrds-instance><span>PGRDS Instance</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgcat-instance-li><input type=checkbox id=m-docspgsqldashboardinstancepgcat-instance-check>
<label for=m-docspgsqldashboardinstancepgcat-instance-check><a href=/docs/pgsql/dashboard/instance/pgcat-instance/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgcat-instance><span>PGCAT Instance</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-persist-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-persist-check>
<label for=m-docspgsqldashboardinstancepgsql-persist-check><a href=/docs/pgsql/dashboard/instance/pgsql-persist/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-persist><span>PGSQL Persist</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-proxy-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-proxy-check>
<label for=m-docspgsqldashboardinstancepgsql-proxy-check><a href=/docs/pgsql/dashboard/instance/pgsql-proxy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-proxy><span>PGSQL Proxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-pgbouncer-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-pgbouncer-check>
<label for=m-docspgsqldashboardinstancepgsql-pgbouncer-check><a href=/docs/pgsql/dashboard/instance/pgsql-pgbouncer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-pgbouncer><span>PGSQL Pgbouncer</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-session-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-session-check>
<label for=m-docspgsqldashboardinstancepgsql-session-check><a href=/docs/pgsql/dashboard/instance/pgsql-session/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-session><span>PGSQL Session</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-xacts-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-xacts-check>
<label for=m-docspgsqldashboardinstancepgsql-xacts-check><a href=/docs/pgsql/dashboard/instance/pgsql-xacts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-xacts><span>PGSQL Xacts</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboardinstancepgsql-exporter-li><input type=checkbox id=m-docspgsqldashboardinstancepgsql-exporter-check>
<label for=m-docspgsqldashboardinstancepgsql-exporter-check><a href=/docs/pgsql/dashboard/instance/pgsql-exporter/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboardinstancepgsql-exporter><span>PGSQL Exporter</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqldashboarddatabase-li><input type=checkbox id=m-docspgsqldashboarddatabase-check>
<label for=m-docspgsqldashboarddatabase-check><a href=/docs/pgsql/dashboard/database/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqldashboarddatabase><span>数据库面板</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgsql-database-li><input type=checkbox id=m-docspgsqldashboarddatabasepgsql-database-check>
<label for=m-docspgsqldashboarddatabasepgsql-database-check><a href=/docs/pgsql/dashboard/database/pgsql-database/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgsql-database><span>PGSQL Database</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgcat-database-li><input type=checkbox id=m-docspgsqldashboarddatabasepgcat-database-check>
<label for=m-docspgsqldashboarddatabasepgcat-database-check><a href=/docs/pgsql/dashboard/database/pgcat-database/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgcat-database><span>PGCAT Database</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgsql-tables-li><input type=checkbox id=m-docspgsqldashboarddatabasepgsql-tables-check>
<label for=m-docspgsqldashboarddatabasepgsql-tables-check><a href=/docs/pgsql/dashboard/database/pgsql-tables/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgsql-tables><span>PGSQL Tables</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgsql-table-li><input type=checkbox id=m-docspgsqldashboarddatabasepgsql-table-check>
<label for=m-docspgsqldashboarddatabasepgsql-table-check><a href=/docs/pgsql/dashboard/database/pgsql-table/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgsql-table><span>PGSQL Table</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgcat-table-li><input type=checkbox id=m-docspgsqldashboarddatabasepgcat-table-check>
<label for=m-docspgsqldashboarddatabasepgcat-table-check><a href=/docs/pgsql/dashboard/database/pgcat-table/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgcat-table><span>PGCAT Table</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgsql-query-li><input type=checkbox id=m-docspgsqldashboarddatabasepgsql-query-check>
<label for=m-docspgsqldashboarddatabasepgsql-query-check><a href=/docs/pgsql/dashboard/database/pgsql-query/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgsql-query><span>PGSQL Query</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgcat-query-li><input type=checkbox id=m-docspgsqldashboarddatabasepgcat-query-check>
<label for=m-docspgsqldashboarddatabasepgcat-query-check><a href=/docs/pgsql/dashboard/database/pgcat-query/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgcat-query><span>PGCAT Query</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgcat-locks-li><input type=checkbox id=m-docspgsqldashboarddatabasepgcat-locks-check>
<label for=m-docspgsqldashboarddatabasepgcat-locks-check><a href=/docs/pgsql/dashboard/database/pgcat-locks/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgcat-locks><span>PGCAT Locks</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqldashboarddatabasepgcat-schema-li><input type=checkbox id=m-docspgsqldashboarddatabasepgcat-schema-check>
<label for=m-docspgsqldashboarddatabasepgcat-schema-check><a href=/docs/pgsql/dashboard/database/pgcat-schema/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqldashboarddatabasepgcat-schema><span>PGCAT Schema</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlmetric-li><input type=checkbox id=m-docspgsqlmetric-check>
<label for=m-docspgsqlmetric-check><a href=/docs/pgsql/metric/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlmetric><i class="fa-solid fa-list-check"></i><span>指标列表</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlparam-li><input type=checkbox id=m-docspgsqlparam-check>
<label for=m-docspgsqlparam-check><a href=/docs/pgsql/param/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlparam><i class="fa-solid fa-sliders"></i><span>参数列表</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlplaybook-li><input type=checkbox id=m-docspgsqlplaybook-check>
<label for=m-docspgsqlplaybook-check><a href=/docs/pgsql/playbook/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlplaybook><i class="fa-solid fa-scroll"></i><span>预置剧本</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqlext-li><input type=checkbox id=m-docspgsqlext-check>
<label for=m-docspgsqlext-check><a href=/docs/pgsql/ext/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlext><i class="fas fa-puzzle-piece"></i><span>扩展插件</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextstart-li><input type=checkbox id=m-docspgsqlextstart-check>
<label for=m-docspgsqlextstart-check><a href=/docs/pgsql/ext/start/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextstart><i class="fa-solid fa-rocket"></i><span>快速开始</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextintro-li><input type=checkbox id=m-docspgsqlextintro-check>
<label for=m-docspgsqlextintro-check><a href=/docs/pgsql/ext/intro/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextintro><i class="fas fa-info-circle"></i><span>扩展简介</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextpkg-li><input type=checkbox id=m-docspgsqlextpkg-check>
<label for=m-docspgsqlextpkg-check><a href=/docs/pgsql/ext/pkg/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextpkg><i class="fa-solid fa-box"></i><span>软件包</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextdownload-li><input type=checkbox id=m-docspgsqlextdownload-check>
<label for=m-docspgsqlextdownload-check><a href=/docs/pgsql/ext/download/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextdownload><i class="fas fa-download"></i><span>下载扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextinstall-li><input type=checkbox id=m-docspgsqlextinstall-check>
<label for=m-docspgsqlextinstall-check><a href=/docs/pgsql/ext/install/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextinstall><i class="fas fa-box-open"></i><span>安装扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextconfig-li><input type=checkbox id=m-docspgsqlextconfig-check>
<label for=m-docspgsqlextconfig-check><a href=/docs/pgsql/ext/config/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextconfig><i class="fa-solid fa-gears"></i><span>配置扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextcreate-li><input type=checkbox id=m-docspgsqlextcreate-check>
<label for=m-docspgsqlextcreate-check><a href=/docs/pgsql/ext/create/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextcreate><i class="fas fa-plus-circle"></i><span>启用扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextupdate-li><input type=checkbox id=m-docspgsqlextupdate-check>
<label for=m-docspgsqlextupdate-check><a href=/docs/pgsql/ext/update/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextupdate><i class="fas fa-arrow-up"></i><span>更新扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextremove-li><input type=checkbox id=m-docspgsqlextremove-check>
<label for=m-docspgsqlextremove-check><a href=/docs/pgsql/ext/remove/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextremove><i class="fas fa-trash"></i><span>移除扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextextension-li><input type=checkbox id=m-docspgsqlextextension-check>
<label for=m-docspgsqlextextension-check><a href=/docs/pgsql/ext/extension/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextextension><i class="fa-brands fa-usb"></i><span>默认扩展</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlextrepo-li><input type=checkbox id=m-docspgsqlextrepo-check>
<label for=m-docspgsqlextrepo-check><a href=/docs/pgsql/ext/repo/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlextrepo><i class="fas fa-warehouse"></i><span>扩展仓库</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqltemplate-li><input type=checkbox id=m-docspgsqltemplate-check>
<label for=m-docspgsqltemplate-check><a href=/docs/pgsql/template/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqltemplate><i class="fas fa-paint-roller"></i><span>场景模板</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltemplatetune-li><input type=checkbox id=m-docspgsqltemplatetune-check>
<label for=m-docspgsqltemplatetune-check><a href=/docs/pgsql/template/tune/ title=默认配置模板的参数优化策略说明 class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltemplatetune><i class="fa-solid fa-gauge-high"></i><span>参数优化策略</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltemplateoltp-li><input type=checkbox id=m-docspgsqltemplateoltp-check>
<label for=m-docspgsqltemplateoltp-check><a href=/docs/pgsql/template/oltp/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltemplateoltp><i class="fa-solid fa-bolt"></i><span>OLTP 模板</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltemplateolap-li><input type=checkbox id=m-docspgsqltemplateolap-check>
<label for=m-docspgsqltemplateolap-check><a href=/docs/pgsql/template/olap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltemplateolap><i class="fa-solid fa-chart-line"></i><span>OLAP 模板</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltemplatecrit-li><input type=checkbox id=m-docspgsqltemplatecrit-check>
<label for=m-docspgsqltemplatecrit-check><a href=/docs/pgsql/template/crit/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltemplatecrit><i class="fa-solid fa-shield-halved"></i><span>CRIT 模板</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqltemplatetiny-li><input type=checkbox id=m-docspgsqltemplatetiny-check>
<label for=m-docspgsqltemplatetiny-check><a href=/docs/pgsql/template/tiny/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqltemplatetiny><i class="fa-solid fa-microchip"></i><span>TINY 模板</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docspgsqlkernel-li><input type=checkbox id=m-docspgsqlkernel-check>
<label for=m-docspgsqlkernel-check><a href=/docs/pgsql/kernel/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docspgsqlkernel><i class="fas fa-heart"></i><span>内核分支</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelpostgres-li><input type=checkbox id=m-docspgsqlkernelpostgres-check>
<label for=m-docspgsqlkernelpostgres-check><a href=/docs/pgsql/kernel/postgres/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelpostgres><i class="fa-solid fa-database"></i><span>PostgreSQL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelsupabase-li><input type=checkbox id=m-docspgsqlkernelsupabase-check>
<label for=m-docspgsqlkernelsupabase-check><a href=/docs/pgsql/kernel/supabase/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelsupabase><i class="fas fa-bolt"></i><span>Supabase</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelcitus-li><input type=checkbox id=m-docspgsqlkernelcitus-check>
<label for=m-docspgsqlkernelcitus-check><a href=/docs/pgsql/kernel/citus/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelcitus><i class="fas fa-lemon"></i><span>Citus</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelbabelfish-li><input type=checkbox id=m-docspgsqlkernelbabelfish-check>
<label for=m-docspgsqlkernelbabelfish-check><a href=/docs/pgsql/kernel/babelfish/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelbabelfish><i class="fab fa-microsoft"></i><span>Babelfish</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelivorysql-li><input type=checkbox id=m-docspgsqlkernelivorysql-check>
<label for=m-docspgsqlkernelivorysql-check><a href=/docs/pgsql/kernel/ivorysql/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelivorysql><i class="fas fa-server"></i><span>IvorySQL</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelpolardb-li><input type=checkbox id=m-docspgsqlkernelpolardb-check>
<label for=m-docspgsqlkernelpolardb-check><a href=/docs/pgsql/kernel/polardb/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelpolardb><i class="fas fa-paw"></i><span>PolarDB PG</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelpolardb-o-li><input type=checkbox id=m-docspgsqlkernelpolardb-o-check>
<label for=m-docspgsqlkernelpolardb-o-check><a href=/docs/pgsql/kernel/polardb-o/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelpolardb-o><i class="fas fa-paw"></i><span>PolarDB Oracle</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelpercona-li><input type=checkbox id=m-docspgsqlkernelpercona-check>
<label for=m-docspgsqlkernelpercona-check><a href=/docs/pgsql/kernel/percona/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelpercona><i class="fa-solid fa-lock"></i><span>Percona</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelpgml-li><input type=checkbox id=m-docspgsqlkernelpgml-check>
<label for=m-docspgsqlkernelpgml-check><a href=/docs/pgsql/kernel/pgml/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelpgml><i class="fas fa-bolt"></i><span>PostgresML</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelopenhalo-li><input type=checkbox id=m-docspgsqlkernelopenhalo-check>
<label for=m-docspgsqlkernelopenhalo-check><a href=/docs/pgsql/kernel/openhalo/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelopenhalo><i class="fa-solid fa-sync"></i><span>OpenHalo</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelorioledb-li><input type=checkbox id=m-docspgsqlkernelorioledb-check>
<label for=m-docspgsqlkernelorioledb-check><a href=/docs/pgsql/kernel/orioledb/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelorioledb><i class="fa-solid fa-bolt"></i><span>OrioleDB</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlkernelcloudberry-li><input type=checkbox id=m-docspgsqlkernelcloudberry-check>
<label for=m-docspgsqlkernelcloudberry-check><a href=/docs/pgsql/kernel/cloudberry/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlkernelcloudberry><i class="fas fa-leaf"></i><span>Cloudberry</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspgsqlfaq-li><input type=checkbox id=m-docspgsqlfaq-check>
<label for=m-docspgsqlfaq-check><a href=/docs/pgsql/faq/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docspgsqlfaq><i class="fa-solid fa-circle-question"></i><span>常见问题</span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/pgsty/pigsty.cc/tree/main/content/docs/pgsql/admin/cluster.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> 查看页面源码</a>
<a href=https://github.com/pgsty/pigsty.cc/edit/main/content/docs/pgsql/admin/cluster.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> 编辑此页</a>
<a href="https://github.com/pgsty/pigsty.cc/new/main/content/docs/pgsql/admin?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> 添加子页面</a>
<a href="https://github.com/pgsty/pigsty.cc/issues/new?title=%e7%ae%a1%e7%90%86%20PostgreSQL%20%e6%95%b0%e6%8d%ae%e5%ba%93%e9%9b%86%e7%be%a4" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> 提交文档问题</a>
<a href=https://github.com/pgsty/pigsty/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> 提交项目问题</a>
<a id=print href=/_print/docs/pgsql/admin/><i class="fa-solid fa-print fa-fw"></i> 整节打印</a></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text></span>
<a class=td-toc-title__link title href=#></a></div><nav id=TableOfContents><ul><li><a href=#速查手册>速查手册</a></li><li><a href=#创建集群>创建集群</a></li><li><a href=#扩容集群>扩容集群</a></li><li><a href=#缩容集群>缩容集群</a></li><li><a href=#销毁集群>销毁集群</a></li><li><a href=#刷新服务>刷新服务</a></li><li><a href=#刷新hba>刷新HBA</a></li><li><a href=#配置集群>配置集群</a></li><li><a href=#克隆集群>克隆集群</a><ul><li><a href=#使用备份集群克隆>使用备份集群克隆</a></li><li><a href=#使用-pitr-克隆>使用 PITR 克隆</a></li></ul></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-module"><h5 class=taxonomy-title>模块</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://pigsty.cc/module/app/ data-taxonomy-term=app><span class=taxonomy-label>APP</span><span class=taxonomy-count>10</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/blog/ data-taxonomy-term=blog><span class=taxonomy-label>BLOG</span><span class=taxonomy-count>5</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/docker/ data-taxonomy-term=docker><span class=taxonomy-label>DOCKER</span><span class=taxonomy-count>5</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/etcd/ data-taxonomy-term=etcd><span class=taxonomy-label>ETCD</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/infra/ data-taxonomy-term=infra><span class=taxonomy-label>INFRA</span><span class=taxonomy-count>8</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/juice/ data-taxonomy-term=juice><span class=taxonomy-label>JUICE</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/kafka/ data-taxonomy-term=kafka><span class=taxonomy-label>KAFKA</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/minio/ data-taxonomy-term=minio><span class=taxonomy-label>MINIO</span><span class=taxonomy-count>10</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/mysql/ data-taxonomy-term=mysql><span class=taxonomy-label>MYSQL</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/pgsql/ data-taxonomy-term=pgsql><span class=taxonomy-label>PGSQL</span><span class=taxonomy-count>97</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/pig/ data-taxonomy-term=pig><span class=taxonomy-label>PIG</span><span class=taxonomy-count>14</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/piglet/ data-taxonomy-term=piglet><span class=taxonomy-label>PIGLET</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/pigsty/ data-taxonomy-term=pigsty><span class=taxonomy-label>PIGSTY</span><span class=taxonomy-count>58</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/pilot/ data-taxonomy-term=pilot><span class=taxonomy-label>PILOT</span><span class=taxonomy-count>5</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/redis/ data-taxonomy-term=redis><span class=taxonomy-label>REDIS</span><span class=taxonomy-count>8</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/software/ data-taxonomy-term=software><span class=taxonomy-label>SOFTWARE</span><span class=taxonomy-count>20</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/module/vibe/ data-taxonomy-term=vibe><span class=taxonomy-label>VIBE</span><span class=taxonomy-count>8</span></a></li></ul></div><div class="taxonomy taxonomy-terms-cloud taxo-categories"><h5 class=taxonomy-title>分类</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://pigsty.cc/categories/faq/ data-taxonomy-term=faq><span class=taxonomy-label>FAQ</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E4%BB%BB%E5%8A%A1/ data-taxonomy-term=%E4%BB%BB%E5%8A%A1><span class=taxonomy-label>任务</span><span class=taxonomy-count>52</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E5%89%A7%E6%9C%AC/ data-taxonomy-term=%E5%89%A7%E6%9C%AC><span class=taxonomy-label>剧本</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E5%8F%82%E6%95%B0/ data-taxonomy-term=%E5%8F%82%E6%95%B0><span class=taxonomy-label>参数</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E5%8F%82%E8%80%83/ data-taxonomy-term=%E5%8F%82%E8%80%83><span class=taxonomy-label>参考</span><span class=taxonomy-count>201</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E5%BA%94%E7%94%A8/ data-taxonomy-term=%E5%BA%94%E7%94%A8><span class=taxonomy-label>应用</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E6%95%99%E7%A8%8B/ data-taxonomy-term=%E6%95%99%E7%A8%8B><span class=taxonomy-label>教程</span><span class=taxonomy-count>27</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E6%A6%82%E5%BF%B5/ data-taxonomy-term=%E6%A6%82%E5%BF%B5><span class=taxonomy-label>概念</span><span class=taxonomy-count>54</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E7%9B%91%E6%8E%A7/ data-taxonomy-term=%E7%9B%91%E6%8E%A7><span class=taxonomy-label>监控</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E7%AE%A1%E7%90%86/ data-taxonomy-term=%E7%AE%A1%E7%90%86><span class=taxonomy-label>管理</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/categories/%E9%85%8D%E7%BD%AE/ data-taxonomy-term=%E9%85%8D%E7%BD%AE><span class=taxonomy-label>配置</span><span class=taxonomy-count>2</span></a></li></ul></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>标签</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://pigsty.cc/tags/agent/ data-taxonomy-term=agent><span class=taxonomy-label>Agent</span><span class=taxonomy-count>4</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/ai/ data-taxonomy-term=ai><span class=taxonomy-label>AI</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/claudecode/ data-taxonomy-term=claudecode><span class=taxonomy-label>ClaudeCode</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/cloud/ data-taxonomy-term=cloud><span class=taxonomy-label>Cloud</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/cmdb/ data-taxonomy-term=cmdb><span class=taxonomy-label>CMDB</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/data/ data-taxonomy-term=data><span class=taxonomy-label>Data</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/dbos/ data-taxonomy-term=dbos><span class=taxonomy-label>DBOS</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/grafana/ data-taxonomy-term=grafana><span class=taxonomy-label>Grafana</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/iac/ data-taxonomy-term=iac><span class=taxonomy-label>IaC</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/mysql/ data-taxonomy-term=mysql><span class=taxonomy-label>MySQL</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/openai/ data-taxonomy-term=openai><span class=taxonomy-label>OpenAI</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/os/ data-taxonomy-term=os><span class=taxonomy-label>OS</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/pg%E5%BC%80%E5%8F%91/ data-taxonomy-term=pg%E5%BC%80%E5%8F%91><span class=taxonomy-label>PG开发</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/pg%E7%94%9F%E6%80%81/ data-taxonomy-term=pg%E7%94%9F%E6%80%81><span class=taxonomy-label>PG生态</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/pigsty/ data-taxonomy-term=pigsty><span class=taxonomy-label>Pigsty</span><span class=taxonomy-count>34</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/postgresql/ data-taxonomy-term=postgresql><span class=taxonomy-label>PostgreSQL</span><span class=taxonomy-count>114</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/privacy/ data-taxonomy-term=privacy><span class=taxonomy-label>Privacy</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/supabase/ data-taxonomy-term=supabase><span class=taxonomy-label>Supabase</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/victoria/ data-taxonomy-term=victoria><span class=taxonomy-label>Victoria</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E4%B8%8B%E4%BA%91/ data-taxonomy-term=%E4%B8%8B%E4%BA%91><span class=taxonomy-label>下云</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/ data-taxonomy-term=%E4%BA%91%E8%AE%A1%E7%AE%97><span class=taxonomy-label>云计算</span><span class=taxonomy-count>46</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/ data-taxonomy-term=%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7><span class=taxonomy-label>可观测性</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E5%90%91%E5%AF%BC/ data-taxonomy-term=%E5%90%91%E5%AF%BC><span class=taxonomy-label>向导</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E5%AE%89%E8%A3%85/ data-taxonomy-term=%E5%AE%89%E8%A3%85><span class=taxonomy-label>安装</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E5%B0%8F%E7%BA%A2%E4%B9%A6/ data-taxonomy-term=%E5%B0%8F%E7%BA%A2%E4%B9%A6><span class=taxonomy-label>小红书</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E5%BC%80%E6%BA%90/ data-taxonomy-term=%E5%BC%80%E6%BA%90><span class=taxonomy-label>开源</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E6%89%A9%E5%B1%95/ data-taxonomy-term=%E6%89%A9%E5%B1%95><span class=taxonomy-label>扩展</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ data-taxonomy-term=%E6%95%B0%E6%8D%AE%E5%BA%93><span class=taxonomy-label>数据库</span><span class=taxonomy-count>64</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E7%AE%A1%E7%90%86/ data-taxonomy-term=%E7%AE%A1%E7%90%86><span class=taxonomy-label>管理</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E8%A1%8C%E4%B8%9A%E6%B4%9E%E5%AF%9F/ data-taxonomy-term=%E8%A1%8C%E4%B8%9A%E6%B4%9E%E5%AF%9F><span class=taxonomy-label>行业洞察</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E9%85%8D%E7%BD%AE/ data-taxonomy-term=%E9%85%8D%E7%BD%AE><span class=taxonomy-label>配置</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/ data-taxonomy-term=%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86><span class=taxonomy-label>配置管理</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://pigsty.cc/tags/%E9%98%BF%E9%87%8C%E4%BA%91/ data-taxonomy-term=%E9%98%BF%E9%87%8C%E4%BA%91><span class=taxonomy-label>阿里云</span><span class=taxonomy-count>1</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>文档</a></li><li class=breadcrumb-item><a href=/docs/pgsql/>模块：PGSQL</a></li><li class=breadcrumb-item><a href=/docs/pgsql/admin/>日常管理</a></li><li class="breadcrumb-item active" aria-current=page>集群管理</li></ol></nav><div class=td-content><h1>管理 PostgreSQL 数据库集群</h1><div class=lead>创建/销毁 PostgreSQL 集群，以及对现有集群进行扩容，缩容，克隆集群。</div><header class=article-meta></header><h2 id=速查手册>速查手册</h2><table class=full-width><thead><tr><th style=text-align:left>操作</th><th style=text-align:left>快捷命令</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left><a href=#%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4><strong>创建集群</strong></a></td><td style=text-align:left><code>bin/pgsql-add &lt;cls></code></td><td style=text-align:left>创建新的 PostgreSQL 集群</td></tr><tr><td style=text-align:left><a href=#%E6%89%A9%E5%AE%B9%E9%9B%86%E7%BE%A4><strong>扩容集群</strong></a></td><td style=text-align:left><code>bin/pgsql-add &lt;cls> &lt;ip...></code></td><td style=text-align:left>为现有集群添加从库副本</td></tr><tr><td style=text-align:left><a href=#%E7%BC%A9%E5%AE%B9%E9%9B%86%E7%BE%A4><strong>缩容集群</strong></a></td><td style=text-align:left><code>bin/pgsql-rm &lt;cls> &lt;ip...></code></td><td style=text-align:left>从集群中移除指定实例</td></tr><tr><td style=text-align:left><a href=#%E9%94%80%E6%AF%81%E9%9B%86%E7%BE%A4><strong>销毁集群</strong></a></td><td style=text-align:left><code>bin/pgsql-rm &lt;cls></code></td><td style=text-align:left>销毁整个 PostgreSQL 集群</td></tr><tr><td style=text-align:left><a href=#%E5%88%B7%E6%96%B0%E6%9C%8D%E5%8A%A1><strong>刷新服务</strong></a></td><td style=text-align:left><code>bin/pgsql-svc &lt;cls> [ip...]</code></td><td style=text-align:left>重载集群的负载均衡配置</td></tr><tr><td style=text-align:left><a href=#%E5%88%B7%E6%96%B0hba><strong>刷新HBA</strong></a></td><td style=text-align:left><code>bin/pgsql-hba &lt;cls> [ip...]</code></td><td style=text-align:left>重载集群的 HBA 访问规则</td></tr><tr><td style=text-align:left><a href=#%E5%85%8B%E9%9A%86%E9%9B%86%E7%BE%A4><strong>克隆集群</strong></a></td><td style=text-align:left>-</td><td style=text-align:left>通过备份集群或 PITR 克隆</td></tr></tbody></table><p>其他管理任务，请参考：<a href=/docs/pgsql/admin/patroni><strong>高可用管理</strong></a>，<a href=/docs/pgsql/admin/user/><strong>管理用户</strong></a>，<a href=/docs/pgsql/admin/db/><strong>管理数据库</strong></a>。</p><hr><h2 id=创建集群>创建集群</h2><p>要创建一个新的 PostgreSQL 集群，请首先在 <a href=/docs/concept/iac/inventory><strong>配置清单</strong></a> 中 <a href=/docs/pgsql/config/cluster><strong>定义集群</strong></a>，然后 <a href=/docs/node/admin#%E6%B7%BB%E5%8A%A0%E8%8A%82%E7%82%B9><strong>纳管节点</strong></a>并进行初始化：</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-00-00-tab data-bs-toggle=tab data-bs-target=#tabs-00-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-00-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-00-01-tab data-bs-toggle=tab data-bs-target=#tabs-00-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-00-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-00-02-tab data-bs-toggle=tab data-bs-target=#tabs-00-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-00-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-0-content><div class="tab-body tab-pane fade show active" id=tabs-00-00 role=tabpanel aria-labelled-by=tabs-00-00-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-add  &lt;cls&gt;     <span style=color:#8f5902;font-style:italic># 添加分组 &lt;cls&gt; 下的节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-01 role=tabpanel aria-labelled-by=tabs-00-01-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml  -l &lt;cls&gt;    <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本添加分组 &lt;cls&gt; 下的节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-02 role=tabpanel aria-labelled-by=tabs-00-02-tab tabindex=0><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add pg-test   <span style=color:#8f5902;font-style:italic># 例子，添加 pg-test 分组下的节点，实际执行 ./node.yml -l pg-test</span>
</span></span></code></pre></div></div></div><p>在被纳管的节点上，可以使用以下命令创建集群：（针对 <strong><code>&lt;cls></code></strong> 分组执行 <a href=/docs/pgsql/playbook#pgsqlyml><strong><code>pgsql.yml</code></strong></a> 剧本）</p><ul class="nav nav-tabs" id=tabs-1 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-01-00-tab data-bs-toggle=tab data-bs-target=#tabs-01-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-01-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-01-01-tab data-bs-toggle=tab data-bs-target=#tabs-01-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-01-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-01-02-tab data-bs-toggle=tab data-bs-target=#tabs-01-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-01-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-1-content><div class="tab-body tab-pane fade show active" id=tabs-01-00 role=tabpanel aria-labelled-by=tabs-01-00-tab tabindex=1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add &lt;cls&gt;     <span style=color:#8f5902;font-style:italic># 创建 PostgreSQL 集群 &lt;cls&gt;</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-01-01 role=tabpanel aria-labelled-by=tabs-01-01-tab tabindex=1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l &lt;cls&gt;    <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本创建 PostgreSQL 集群 &lt;cls&gt;</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-01-02 role=tabpanel aria-labelled-by=tabs-01-02-tab tabindex=1><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add pg-test   <span style=color:#8f5902;font-style:italic># 例子，创建 pg-test 集群</span>
</span></span></code></pre></div></div></div><p><strong>示例：创建三节点 PG 集群 <code>pg-test</code></strong></p><link rel=stylesheet href=/css/asciinema-player.css><script src=/js/asciinema-player.min.js></script><div id=asciinema-942dc186323899bcee0f4643447fbd01 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-942dc186323899bcee0f4643447fbd01",o="/demo/pgsql.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.3",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,e.markers=[[4,"执行"]],i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><div class="alert alert-warning" role=alert><div class="h4 alert-heading" role=heading>针对已经存在的集群重新执行创建存在风险</div><p>如果您在已经存在的集群上重新执行创建操作，Pigsty 不会移除已有的数据文件，但现有服务配置会被覆盖，集群会发生 <strong>重启</strong>！
此外，如果你在 <a href=/docs/pgsql/config/db#baseline><strong>数据库定义</strong></a> 中指定了 <code>baseline</code> SQL ，它也会重新执行，如果里面包含删除/覆盖逻辑，可能会导致 <strong>数据丢失</strong>。</p></div><hr><h2 id=扩容集群>扩容集群</h2><p>若要将新从库添加到 <strong>现有的 PostgreSQL 集群</strong> 中，您需要将 <a href=/docs/pgsql/config/cluster><strong>实例定义</strong></a> 添加到 <a href=/docs/concept/iac/inventory><strong>配置清单</strong></a>：<code>all.children.&lt;cls>.hosts</code> 中。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-test</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># 已存在的成员</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># 已存在的成员</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 3, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;--- 新成员</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>扩容集群的操作与 <a href=#%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4><strong>创建集群</strong></a> 非常类似，首先需要将扩容的节点纳入 Pigsty 管理：<a href=/docs/node/admin#%E6%B7%BB%E5%8A%A0%E8%8A%82%E7%82%B9><strong>添加节点</strong></a>：</p><ul class="nav nav-tabs" id=tabs-4 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-04-00-tab data-bs-toggle=tab data-bs-target=#tabs-04-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-04-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-04-01-tab data-bs-toggle=tab data-bs-target=#tabs-04-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-04-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-04-02-tab data-bs-toggle=tab data-bs-target=#tabs-04-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-04-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-4-content><div class="tab-body tab-pane fade show active" id=tabs-04-00 role=tabpanel aria-labelled-by=tabs-04-00-tab tabindex=4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-add &lt;ip&gt;       <span style=color:#8f5902;font-style:italic># 添加 IP 地址为 &lt;ip&gt; 的节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-04-01 role=tabpanel aria-labelled-by=tabs-04-01-tab tabindex=4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node.yml -l &lt;ip&gt;      <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本添加 &lt;ip&gt; 对应的节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-04-02 role=tabpanel aria-labelled-by=tabs-04-02-tab tabindex=4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-add 10.10.10.13    <span style=color:#8f5902;font-style:italic># 例子，添加 IP 为 10.10.10.13 的节点，实际执行 ./node.yml -l 10.10.10.13</span>
</span></span></code></pre></div></div></div><p>然后在新节点上运行以下命令以扩容集群（针对新节点安装 <a href=/docs/pgsql><strong>PGSQL 模块</strong></a>，使用与现有集群相同的 <a href=/docs/pgsql/param#pg_cluster><strong><code>pg_cluster</code></strong></a>）</p><ul class="nav nav-tabs" id=tabs-5 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-05-00-tab data-bs-toggle=tab data-bs-target=#tabs-05-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-05-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-05-01-tab data-bs-toggle=tab data-bs-target=#tabs-05-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-05-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-05-02-tab data-bs-toggle=tab data-bs-target=#tabs-05-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-05-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-5-content><div class="tab-body tab-pane fade show active" id=tabs-05-00 role=tabpanel aria-labelled-by=tabs-05-00-tab tabindex=5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add &lt;cls&gt; &lt;ip&gt;  <span style=color:#8f5902;font-style:italic># 添加 IP 地址为 &lt;ip&gt; 的节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-05-01 role=tabpanel aria-labelled-by=tabs-05-01-tab tabindex=5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l &lt;ip&gt;       <span style=color:#8f5902;font-style:italic># 核心逻辑：使用 Ansible 剧本在 &lt;ip&gt; 节点上安装 PGSQL 模块</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-05-02 role=tabpanel aria-labelled-by=tabs-05-02-tab tabindex=5><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add pg-test 10.10.10.13   <span style=color:#8f5902;font-style:italic># 示例，为 pg-test 集群扩容 IP 为 10.10.10.13 的节点</span>
</span></span></code></pre></div></div></div><p>扩容完成后，您应当 <a href=/docs/pgsql/admin/cluster#%E5%88%B7%E6%96%B0%E6%9C%8D%E5%8A%A1><strong>刷新服务</strong></a> 以将新成员添加至负载均衡器中以实际承载流量。</p><p><strong>示例：为两节点集群 <code>pg-test</code> 扩容一个新从库 <code>10.10.10.13</code></strong></p><div id=asciinema-05fce5eacdeb3446795df8299bfa61bb class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-05fce5eacdeb3446795df8299bfa61bb",o="/demo/pgsql-append.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.2",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=缩容集群>缩容集群</h2><p>若要从 <strong>现有的 PostgreSQL 集群</strong> 中移除副本，您需要从 <a href=/docs/concept/iac/inventory><strong>配置清单</strong></a> 的 <code>all.children.&lt;cls>.hosts</code> 中移除对应的 <a href=/docs/pgsql/config/cluster><strong>实例定义</strong></a>。</p><p>缩容集群首先需要卸载目标节点上的 PGSQL 模块（针对 <strong><code>&lt;ip></code></strong> 执行 <a href=/docs/pgsql/playbook#pgsql-rmyml><strong><code>pgsql-rm.yml</code></strong></a> 剧本）：</p><ul class="nav nav-tabs" id=tabs-7 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-07-00-tab data-bs-toggle=tab data-bs-target=#tabs-07-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-07-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-07-01-tab data-bs-toggle=tab data-bs-target=#tabs-07-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-07-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-07-02-tab data-bs-toggle=tab data-bs-target=#tabs-07-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-07-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-7-content><div class="tab-body tab-pane fade show active" id=tabs-07-00 role=tabpanel aria-labelled-by=tabs-07-00-tab tabindex=7><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-rm &lt;cls&gt; &lt;ip&gt;   <span style=color:#8f5902;font-style:italic># 从集群 &lt;cls&gt; 中移除 &lt;ip&gt; 节点上的 PostgreSQL 实例</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-07-01 role=tabpanel aria-labelled-by=tabs-07-01-tab tabindex=7><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-rm.yml -l &lt;ip&gt;    <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本移除 &lt;ip&gt; 节点上的 PostgreSQL 实例</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-07-02 role=tabpanel aria-labelled-by=tabs-07-02-tab tabindex=7><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-rm pg-test 10.10.10.13  <span style=color:#8f5902;font-style:italic># 例子，从 pg-test 集群移除 10.10.10.13 节点</span>
</span></span></code></pre></div></div></div><p>移除 PGSQL 模块后，您可以选择将节点从 Pigsty 管理中移除：<a href=/docs/node/admin#%E7%A7%BB%E9%99%A4%E8%8A%82%E7%82%B9><strong>移除节点</strong></a>（可选）：</p><ul class="nav nav-tabs" id=tabs-8 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-08-00-tab data-bs-toggle=tab data-bs-target=#tabs-08-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-08-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-08-01-tab data-bs-toggle=tab data-bs-target=#tabs-08-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-08-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-08-02-tab data-bs-toggle=tab data-bs-target=#tabs-08-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-08-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-8-content><div class="tab-body tab-pane fade show active" id=tabs-08-00 role=tabpanel aria-labelled-by=tabs-08-00-tab tabindex=8><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-rm &lt;ip&gt;          <span style=color:#8f5902;font-style:italic># 从 Pigsty 管理中移除 &lt;ip&gt; 节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-08-01 role=tabpanel aria-labelled-by=tabs-08-01-tab tabindex=8><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node-rm.yml -l &lt;ip&gt;     <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本从 Pigsty 管理中移除 &lt;ip&gt; 节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-08-02 role=tabpanel aria-labelled-by=tabs-08-02-tab tabindex=8><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-rm 10.10.10.13   <span style=color:#8f5902;font-style:italic># 例子，从 Pigsty 管理中移除 10.10.10.13 节点</span>
</span></span></code></pre></div></div></div><p>缩容完成后，您应当从 <a href=/docs/concept/iac/inventory><strong>配置清单</strong></a> 中移除该实例的定义，然后 <a href=/docs/pgsql/admin/cluster#%E5%88%B7%E6%96%B0%E6%9C%8D%E5%8A%A1><strong>刷新服务</strong></a> 以将已它从负载均衡器中踢除。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-test</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 3, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># &lt;--- 执行后移除此行</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>示例：从三节点集群 <code>pg-test</code> 中缩容一个从库 <code>10.10.10.13</code></strong></p><div id=asciinema-89bfaa9d26b25502fcaa59352090b5f0 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-89bfaa9d26b25502fcaa59352090b5f0",o="/demo/pgsql-shrink.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.2",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=销毁集群>销毁集群</h2><p>销毁集群需要在集群的所有节点上卸载 PGSQL 模块（针对 <strong><code>&lt;cls></code></strong> 执行 <a href=/docs/pgsql/playbook#pgsql-rmyml><strong><code>pgsql-rm.yml</code></strong></a> 剧本）：</p><ul class="nav nav-tabs" id=tabs-10 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-10-00-tab data-bs-toggle=tab data-bs-target=#tabs-10-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-10-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-10-01-tab data-bs-toggle=tab data-bs-target=#tabs-10-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-10-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-10-02-tab data-bs-toggle=tab data-bs-target=#tabs-10-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-10-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-10-content><div class="tab-body tab-pane fade show active" id=tabs-10-00 role=tabpanel aria-labelled-by=tabs-10-00-tab tabindex=10><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-rm &lt;cls&gt;        <span style=color:#8f5902;font-style:italic># 销毁整个 PostgreSQL 集群 &lt;cls&gt;</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-10-01 role=tabpanel aria-labelled-by=tabs-10-01-tab tabindex=10><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-rm.yml -l &lt;cls&gt;   <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本销毁整个 PostgreSQL 集群 &lt;cls&gt;</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-10-02 role=tabpanel aria-labelled-by=tabs-10-02-tab tabindex=10><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-rm pg-test      <span style=color:#8f5902;font-style:italic># 例子，销毁 pg-test 集群</span>
</span></span></code></pre></div></div></div><p>销毁 PGSQL 模块后，您可以选择将节点一并从 Pigsty 管理中移除：<a href=/docs/node/admin#%E7%A7%BB%E9%99%A4%E8%8A%82%E7%82%B9><strong>移除节点</strong></a>（可选，如果还有其他服务可以保留）：</p><ul class="nav nav-tabs" id=tabs-11 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-11-00-tab data-bs-toggle=tab data-bs-target=#tabs-11-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-11-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-11-01-tab data-bs-toggle=tab data-bs-target=#tabs-11-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-11-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-11-02-tab data-bs-toggle=tab data-bs-target=#tabs-11-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-11-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-11-content><div class="tab-body tab-pane fade show active" id=tabs-11-00 role=tabpanel aria-labelled-by=tabs-11-00-tab tabindex=11><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-rm &lt;cls&gt;         <span style=color:#8f5902;font-style:italic># 从 Pigsty 管理中移除 &lt;cls&gt; 分组下的所有节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-11-01 role=tabpanel aria-labelled-by=tabs-11-01-tab tabindex=11><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./node-rm.yml -l &lt;cls&gt;    <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本从 Pigsty 管理中移除 &lt;cls&gt; 分组下的所有节点</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-11-02 role=tabpanel aria-labelled-by=tabs-11-02-tab tabindex=11><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/node-rm pg-test       <span style=color:#8f5902;font-style:italic># 例子，从 Pigsty 管理中移除 pg-test 分组下的所有节点</span>
</span></span></code></pre></div></div></div><p>销毁结束后，建议及时从 <a href=/docs/concept/iac/inventory><strong>配置清单</strong></a> 中移除整个 <a href=/docs/pgsql/config/cluster><strong>集群定义</strong></a>。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-test</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># 清理这个集群定义分组</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 3, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p><strong>示例：销毁三节点 PG 集群 <code>pg-test</code></strong></p><div id=asciinema-4b148718963c7bab646e97087cabccda class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-4b148718963c7bab646e97087cabccda",o="/demo/pgsql-rm.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.2",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><p>注意：如果为这个集群配置了 <a href=/docs/pgsql/param#pg_safeguard><strong><code>pg_safeguard</code></strong></a>（或全局设置为 <code>true</code>），<code>pgsql-rm.yml</code> 将中止执行，以避免意外销毁集群。
您可以使用剧本命令行参数明确地覆盖它，以强制执行销毁。
此外默认情况下，集群的备份仓库将同集群一并删除。如果你希望保留备份（例如在使用集中式备份仓库时），可以设置 <a href=/docs/pgsql/param#pg_rm_backup><strong><code>pg_rm_backup=false</code></strong></a> 参数：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-rm.yml -l pg-meta -e <span style=color:#000>pg_safeguard</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>    <span style=color:#8f5902;font-style:italic># 强制销毁受保护的 pg 集群 pg-meta</span>
</span></span><span style=display:flex><span>./pgsql-rm.yml -l pg-meta -e <span style=color:#000>pg_rm_backup</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>false</span>    <span style=color:#8f5902;font-style:italic># 在销毁集群过程中保留其备份仓库</span>
</span></span></code></pre></div><hr><h2 id=刷新服务>刷新服务</h2><p>PostgreSQL 集群通过主机节点上的 <a href=/docs/concept/arch/pgsql#haproxy><strong>HAProxy</strong></a> 对外提供 <a href=/docs/pgsql/service/><strong>服务</strong></a>。
当服务定义变化，实例权重变化，或者集群成员发生变化时（例如，集群 <a href=#%E6%89%A9%E5%AE%B9%E9%9B%86%E7%BE%A4><strong>扩容</strong></a> / <a href=#%E7%BC%A9%E5%AE%B9%E9%9B%86%E7%BE%A4><strong>缩容</strong></a>，主从切换／故障转移），您需要择机刷新服务以更新负载均衡器的配置。</p><p>要在整个集群或特定实例上刷新服务配置（针对 <strong><code>&lt;cls></code></strong> 或 <strong><code>&lt;ip></code></strong> 执行 <a href=/docs/pgsql/playbook#pgsqlyml><strong><code>pgsql.yml</code></strong></a> 的 <code>pg_service</code> 子任务）：</p><ul class="nav nav-tabs" id=tabs-13 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-13-00-tab data-bs-toggle=tab data-bs-target=#tabs-13-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-13-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-13-01-tab data-bs-toggle=tab data-bs-target=#tabs-13-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-13-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-13-02-tab data-bs-toggle=tab data-bs-target=#tabs-13-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-13-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-13-content><div class="tab-body tab-pane fade show active" id=tabs-13-00 role=tabpanel aria-labelled-by=tabs-13-00-tab tabindex=13><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-svc &lt;cls&gt;           <span style=color:#8f5902;font-style:italic># 刷新整个集群 &lt;cls&gt; 的服务配置</span>
</span></span><span style=display:flex><span>bin/pgsql-svc &lt;cls&gt; &lt;ip...&gt;   <span style=color:#8f5902;font-style:italic># 刷新集群 &lt;cls&gt; 中指定实例的服务配置</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-13-01 role=tabpanel aria-labelled-by=tabs-13-01-tab tabindex=13><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l &lt;cls&gt; -t pg_service -e <span style=color:#000>pg_reload</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>        <span style=color:#8f5902;font-style:italic># 刷新整个集群的服务配置</span>
</span></span><span style=display:flex><span>./pgsql.yml -l &lt;ip&gt;  -t pg_service -e <span style=color:#000>pg_reload</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>        <span style=color:#8f5902;font-style:italic># 刷新指定实例的服务配置</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-13-02 role=tabpanel aria-labelled-by=tabs-13-02-tab tabindex=13><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-svc pg-test                 <span style=color:#8f5902;font-style:italic># 例子，刷新 pg-test 集群的服务配置</span>
</span></span><span style=display:flex><span>bin/pgsql-svc pg-test 10.10.10.13     <span style=color:#8f5902;font-style:italic># 例子，刷新 pg-test 集群中 10.10.10.13 实例的服务配置</span>
</span></span></code></pre></div></div></div><blockquote><p>备注：如果您使用集中式的专用负载均衡集群（<a href=/docs/pgsql/param#pg_service_provider><strong><code>pg_service_provider</code></strong></a>），那么只有刷新集群主库时才会更新负载均衡配置。</p></blockquote><p><strong>示例：刷新集群 <code>pg-test</code> 的服务配置</strong></p><div id=asciinema-d04ae8e428be2e84e61f51c21cb4556e class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-d04ae8e428be2e84e61f51c21cb4556e",o="/demo/pgsql-svc.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.2",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><details><summary>示例：重载PG服务以踢除一个实例</summary><p><a href=https://asciinema.org/a/568815><img src=https://asciinema.org/a/568815.svg alt=asciicast></a></p></details><hr><h2 id=刷新hba>刷新HBA</h2><p>当您修改了 HBA 相关配置后，需要刷新 HBA 规则以应用更改。（<a href=/docs/pgsql/param#pg_hba_rules><strong><code>pg_hba_rules</code></strong></a> / <a href=/docs/pgsql/param#pgb_hba_rules><strong><code>pgb_hba_rules</code></strong></a>）
如果您有任何特定于角色的 HBA 规则，或者在 IP 地址段中引用了集群成员的别名，那么当主从切换/集群扩缩容后也可能需要刷新 HBA。</p><p>要在整个集群或特定实例上刷新 PG 和 Pgbouncer 的 HBA 规则（针对 <strong><code>&lt;cls></code></strong> 或 <strong><code>&lt;ip></code></strong> 执行 <a href=/docs/pgsql/playbook#pgsqlyml><strong><code>pgsql.yml</code></strong></a> 的 HBA 相关子任务）：</p><ul class="nav nav-tabs" id=tabs-15 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-15-00-tab data-bs-toggle=tab data-bs-target=#tabs-15-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-15-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-15-01-tab data-bs-toggle=tab data-bs-target=#tabs-15-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-15-01 aria-selected=false>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-15-02-tab data-bs-toggle=tab data-bs-target=#tabs-15-02 role=tab data-td-tp-persist=示例 aria-controls=tabs-15-02 aria-selected=false>
示例</button></li></ul><div class=tab-content id=tabs-15-content><div class="tab-body tab-pane fade show active" id=tabs-15-00 role=tabpanel aria-labelled-by=tabs-15-00-tab tabindex=15><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-hba &lt;cls&gt;           <span style=color:#8f5902;font-style:italic># 刷新整个集群 &lt;cls&gt; 的 HBA 规则</span>
</span></span><span style=display:flex><span>bin/pgsql-hba &lt;cls&gt; &lt;ip...&gt;   <span style=color:#8f5902;font-style:italic># 刷新集群 &lt;cls&gt; 中指定实例的 HBA 规则</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-15-01 role=tabpanel aria-labelled-by=tabs-15-01-tab tabindex=15><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l &lt;cls&gt; -t pg_hba,pg_reload,pgbouncer_hba,pgbouncer_reload -e <span style=color:#000>pg_reload</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>   <span style=color:#8f5902;font-style:italic># 刷新整个集群</span>
</span></span><span style=display:flex><span>./pgsql.yml -l &lt;ip&gt;  -t pg_hba,pg_reload,pgbouncer_hba,pgbouncer_reload -e <span style=color:#000>pg_reload</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87>true</span>   <span style=color:#8f5902;font-style:italic># 刷新指定实例</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-15-02 role=tabpanel aria-labelled-by=tabs-15-02-tab tabindex=15><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-hba pg-test                 <span style=color:#8f5902;font-style:italic># 例子，刷新 pg-test 集群的 HBA 规则</span>
</span></span><span style=display:flex><span>bin/pgsql-hba pg-test 10.10.10.13     <span style=color:#8f5902;font-style:italic># 例子，刷新 pg-test 集群中 10.10.10.13 实例的 HBA 规则</span>
</span></span></code></pre></div></div></div><p><strong>示例：刷新集群 <code>pg-test</code> 的 HBA 规则</strong></p><div id=asciinema-ff9b13ed062434f2b3b348cc9909ad10 class="asciinema-container td-max-width-on-larger-screens" style="margin:1em 0"></div><script>(function(){var n,s="asciinema-ff9b13ed062434f2b3b348cc9909ad10",o="/demo/pgsql-hba.cast",e="auto",i=null;function a(){var e=document.documentElement.getAttribute("data-bs-theme");return e==="dark"?"solarized-dark":e==="light"?"solarized-light":window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"solarized-dark":"solarized-light"}function r(){return e==="auto"?a():e}function t(){var e,t=document.getElementById(s);t.innerHTML="",e={theme:r(),speed:"1.2",startAt:0,fit:"width"},e.autoPlay=!0,e.loop=!0,i=AsciinemaPlayer.create(o,t,e)}t(),e==="auto"&&(n=new MutationObserver(function(e){e.forEach(function(e){e.attributeName==="data-bs-theme"&&t()})}),n.observe(document.documentElement,{attributes:!0}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(){var e=document.documentElement.getAttribute("data-bs-theme");(!e||e==="auto")&&t()}))})()</script><hr><h2 id=配置集群>配置集群</h2><p>PostgreSQL 的配置参数由 Patroni 管理，初始参数由 <a href=/docs/pgsql/template/><strong>Patroni 配置模板</strong></a> 指定。
集群初始化之后，配置存储在 Etcd 中，并由 Patroni 进行动态管理，并在集群中同步与共享。
Patroni 本身的 <a href=/docs/pgsql/admin/patroni#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE><strong>配置参数</strong></a> 大部分可以通过 <code>patronictl</code>命令行工具修改。
其余参数（例如，etcd DCS 配置，日志/RestAPI 等配置）则可以通过下面的子任务进行更新。例如，当 <a href=/docs/etcd><strong>etcd</strong></a> 集群成员发生变动时，你可以刷新 Patroni 配置：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l pg-test -t pg_conf                   <span style=color:#8f5902;font-style:italic># 更新 Patroni 配置文件</span>
</span></span><span style=display:flex><span>ansible pg-test -b -a <span style=color:#4e9a06>&#39;systemctl reload patroni&#39;</span>    <span style=color:#8f5902;font-style:italic># 重载 Patroni 服务</span>
</span></span></code></pre></div><p>您可以在不同层次上覆盖 Patroni 集中管理的默认，例如单独 <a href=/docs/pgsql/param#pg_parameters><strong>为实例指定配置参数</strong></a>；
单独为 <a href=/docs/pgsql/admin/user><strong>为用户指定配置参数</strong></a>，或者 <a href=/docs/pgsql/admin/db><strong>为数据库指定配置参数</strong></a>。</p><hr><h2 id=克隆集群>克隆集群</h2><p>有两种克隆集群的方式：使用 <a href=/docs/pgsql/config/cluster#%E5%A4%87%E4%BB%BD%E9%9B%86%E7%BE%A4><strong>备份集群</strong></a> 功能，或者使用 <a href=/docs/pgsql/backup/restore#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B><strong>时间点恢复</strong></a> 功能。
前者配置简单，无需依赖，但只能克隆指定集群的最新状态；后者依赖集中式的 <a href=/docs/pgsql/backup/repository><strong>备份仓库</strong></a>（例如 MinIO），但可以克隆到备份保留期内的任意时间点。</p><table><thead><tr><th style=text-align:left>方式</th><th style=text-align:left>优点</th><th style=text-align:left>缺点</th><th style=text-align:left>适用场景</th></tr></thead><tbody><tr><td style=text-align:left>备份集群</td><td style=text-align:left>配置简单，无需依赖</td><td style=text-align:left>只能克隆最新状态</td><td style=text-align:left>灾备，读写分离，迁移</td></tr><tr><td style=text-align:left>PITR</td><td style=text-align:left>可恢复到任意时间点</td><td style=text-align:left>依赖集中式备份仓库</td><td style=text-align:left>误操作恢复，数据审计</td></tr></tbody></table><h3 id=使用备份集群克隆>使用备份集群克隆</h3><p>备份集群（Standby Cluster）通过流复制从上游集群持续同步数据，是克隆集群最简单的方式。
只需在新集群主库上指定 <a href=/docs/pgsql/param#pg_upstream><strong><code>pg_upstream</code></strong></a> 参数，即可自动从上游集群拉取数据。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># pg-test 是原始集群</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-test</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.11</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># pg-test2 是 pg-test 的备份集群（克隆）</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-test2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role: primary, pg_upstream</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#0000cf;font-weight:700>10.10.10.11</span><span style=color:#f8f8f8> </span>}<span style=color:#f8f8f8>  </span><span style=color:#8f5902;font-style:italic># 指定上游</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>10.10.10.13</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 2, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>replica }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-test2 }</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>使用以下命令创建备份集群：</p><ul class="nav nav-tabs" id=tabs-17 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-17-00-tab data-bs-toggle=tab data-bs-target=#tabs-17-00 role=tab data-td-tp-persist=脚本 aria-controls=tabs-17-00 aria-selected=true>
脚本</button></li><li class=nav-item><button class=nav-link id=tabs-17-01-tab data-bs-toggle=tab data-bs-target=#tabs-17-01 role=tab data-td-tp-persist=剧本 aria-controls=tabs-17-01 aria-selected=false>
剧本</button></li></ul><div class=tab-content id=tabs-17-content><div class="tab-body tab-pane fade show active" id=tabs-17-00 role=tabpanel aria-labelled-by=tabs-17-00-tab tabindex=17><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>bin/pgsql-add pg-test2    <span style=color:#8f5902;font-style:italic># 创建备份集群，自动从上游 pg-test 克隆数据</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-17-01 role=tabpanel aria-labelled-by=tabs-17-01-tab tabindex=17><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql.yml -l pg-test2   <span style=color:#8f5902;font-style:italic># 直接使用 Ansible 剧本创建备份集群</span>
</span></span></code></pre></div></div></div><p>备份集群会持续追随上游集群，保持数据同步。您可以随时将其 <strong>提升</strong> 为独立集群：</p><details><summary>示例：提升备份集群为独立集群</summary><p>通过 <a href=#%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4><strong>配置集群</strong></a> 擦除 <code>standby_cluster</code> 配置段，即可将备份集群提升为独立集群：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pg edit-config pg-test2
</span></span><span style=display:flex><span>-standby_cluster:
</span></span><span style=display:flex><span>-  create_replica_methods:
</span></span><span style=display:flex><span>-  - basebackup
</span></span><span style=display:flex><span>-  host: 10.10.10.11
</span></span><span style=display:flex><span>-  port: <span style=color:#0000cf;font-weight:700>5432</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Apply these changes? <span style=color:#ce5c00;font-weight:700>[</span>y/N<span style=color:#ce5c00;font-weight:700>]</span>: y
</span></span></code></pre></div><p>提升后，<code>pg-test2</code> 将成为可以独立承载写入请求的独立集群，与原集群 <code>pg-test</code> 分叉。</p></details><details><summary>示例：更改复制上游</summary><p>如果上游集群发生主从切换，您可以通过 <a href=#%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4><strong>配置集群</strong></a> 更改备份集群的复制上游：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pg edit-config pg-test2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> standby_cluster:
</span></span><span style=display:flex><span>   create_replica_methods:
</span></span><span style=display:flex><span>   - basebackup
</span></span><span style=display:flex><span>-  host: 10.10.10.11     <span style=color:#8f5902;font-style:italic># &lt;--- 旧的上游</span>
</span></span><span style=display:flex><span>+  host: 10.10.10.14     <span style=color:#8f5902;font-style:italic># &lt;--- 新的上游</span>
</span></span><span style=display:flex><span>   port: <span style=color:#0000cf;font-weight:700>5432</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Apply these changes? <span style=color:#ce5c00;font-weight:700>[</span>y/N<span style=color:#ce5c00;font-weight:700>]</span>: y
</span></span></code></pre></div></details><h3 id=使用-pitr-克隆>使用 PITR 克隆</h3><p><a href=/docs/pgsql/backup/restore><strong>时间点恢复</strong></a>（PITR）允许您将集群恢复到备份保留期内的任意时间点。
此方式依赖集中式的 <a href=/docs/pgsql/backup/repository><strong>备份仓库</strong></a>（如 MinIO/S3），但功能更加强大。</p><p>要使用 PITR 克隆集群，在配置中添加 <a href=/docs/pgsql/backup/restore#pitr-%E5%8F%82%E6%95%B0%E5%AE%9A%E4%B9%89><strong><code>pg_pitr</code></strong></a> 参数指定恢复目标：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 从 pg-meta 集群的备份克隆一个新集群 pg-meta2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>pg-meta2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>10.10.10.12</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span>{<span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>pg_seq: 1, pg_role</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>primary } }</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta2</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>pg_pitr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>cluster</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>pg-meta                   </span><span style=color:#f8f8f8> </span><span style=color:#8f5902;font-style:italic># 从 pg-meta 的备份恢复</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#204a87;font-weight:700>time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;2025-01-10 10:00:00+00&#39;</span><span style=color:#f8f8f8>      </span><span style=color:#8f5902;font-style:italic># 恢复到指定时间点</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><p>使用 <code>pgsql-pitr.yml</code> 剧本执行克隆：</p><ul class="nav nav-tabs" id=tabs-18 role=tablist><li class=nav-item><button class="nav-link active" id=tabs-18-00-tab data-bs-toggle=tab data-bs-target=#tabs-18-00 role=tab data-td-tp-persist=剧本 aria-controls=tabs-18-00 aria-selected=true>
剧本</button></li><li class=nav-item><button class=nav-link id=tabs-18-01-tab data-bs-toggle=tab data-bs-target=#tabs-18-01 role=tab data-td-tp-persist=命令行 aria-controls=tabs-18-01 aria-selected=false>
命令行</button></li></ul><div class=tab-content id=tabs-18-content><div class="tab-body tab-pane fade show active" id=tabs-18-00 role=tabpanel aria-labelled-by=tabs-18-00-tab tabindex=18><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./pgsql-pitr.yml -l pg-meta2    <span style=color:#8f5902;font-style:italic># 从 pg-meta 备份克隆 pg-meta2</span>
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-18-01 role=tabpanel aria-labelled-by=tabs-18-01-tab tabindex=18><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 也可以通过命令行参数指定 PITR 选项</span>
</span></span><span style=display:flex><span>./pgsql-pitr.yml -l pg-meta2 -e <span style=color:#4e9a06>&#39;{&#34;pg_pitr&#34;: {&#34;cluster&#34;: &#34;pg-meta&#34;, &#34;time&#34;: &#34;2025-01-10 10:00:00+00&#34;}}&#39;</span>
</span></span></code></pre></div></div></div><p>PITR 支持多种恢复目标类型：</p><table><thead><tr><th style=text-align:left>目标类型</th><th style=text-align:left>参数示例</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left>时间点</td><td style=text-align:left><code>time: "2025-01-10 10:00:00+00"</code></td><td style=text-align:left>恢复到指定时间戳</td></tr><tr><td style=text-align:left>事务ID</td><td style=text-align:left><code>xid: "250000"</code></td><td style=text-align:left>恢复到指定事务之前/之后</td></tr><tr><td style=text-align:left>恢复点</td><td style=text-align:left><code>name: "before_migration"</code></td><td style=text-align:left>恢复到命名恢复点</td></tr><tr><td style=text-align:left>LSN</td><td style=text-align:left><code>lsn: "0/4001C80"</code></td><td style=text-align:left>恢复到指定 WAL 位置</td></tr><tr><td style=text-align:left>最新</td><td style=text-align:left><code>type: "latest"</code></td><td style=text-align:left>恢复到 WAL 归档末尾</td></tr></tbody></table><div class="alert alert-info" role=alert><div class="h4 alert-heading" role=heading>PITR 恢复后处理</div><p>恢复后的集群会<strong>禁用</strong> <code>archive_mode</code>，以防止意外的 WAL 写入覆盖归档。
如果恢复后的数据库状态正常，您应当启用归档并执行新的全量备份：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>psql -c <span style=color:#4e9a06>&#39;ALTER SYSTEM RESET archive_mode; SELECT pg_reload_conf();&#39;</span>
</span></span><span style=display:flex><span>pg-backup full    <span style=color:#8f5902;font-style:italic># 执行新的全量备份</span>
</span></span></code></pre></div></div><p>更多 PITR 的详细用法，请参考 <a href=/docs/pgsql/backup/restore><strong>恢复操作</strong></a> 文档。</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>意见反馈</h2><p class=feedback--question>这个页面对您有帮助吗？</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">有帮助</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">没帮助</button><p class="feedback--response feedback--response-yes">感谢反馈！请 <a href=https://github.com/pgsty/pigsty/issues/new>告诉我们如何改进</a>。</p><p class="feedback--response feedback--response-no">抱歉给您带来不便。请 <a href=https://github.com/pgsty/pigsty/issues/new>告诉我们如何改进</a>。</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","page_helpful",{event_category:"Helpful",event_label:window.location.pathname,value:e})};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(100)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class=td-page-meta__lastmod>最后修改 2026-02-08: <a data-proofer-ignore href=https://github.com/pgsty/pigsty.cc/commit/646930b6fd6c82c33655783a32d63216b24d4c6b>fix dead links (646930b)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=邮件 aria-label=邮件><a target=_blank rel=noopener href=mailto:rh@vonng.com aria-label=邮件><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub - Vonng" aria-label="GitHub - Vonng"><a target=_blank rel=noopener href=https://github.com/Vonng aria-label="GitHub - Vonng"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Vonng" aria-label="X - Vonng"><a target=_blank rel=noopener href=https://x.com/RonVonng aria-label="X - Vonng"><i class="fab fa-x-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="X - Pigsty" aria-label="X - Pigsty"><a target=_blank rel=noopener href=https://x.com/PlGSTY aria-label="X - Pigsty"><i class="fab fa-twitter"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="LinkedIn - Vonng" aria-label="LinkedIn - Vonng"><a target=_blank rel=noopener href=https://www.linkedin.com/in/vonng/ aria-label="LinkedIn - Vonng"><i class="fab fa-linkedin"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Discord aria-label=Discord><a target=_blank rel=noopener href=https://discord.gg/wDzt5VyWEz aria-label=Discord><i class="fab fa-discord"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Telegram aria-label=Telegram><a target=_blank rel=noopener href=https://t.me/joinchat/gV9zfZraNPM3YjFh aria-label=Telegram><i class="fab fa-telegram"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=微信 aria-label=微信><a target=_blank rel=noopener href=/img/pigsty/pigsty-cc.jpg aria-label=微信><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=论坛 aria-label=论坛><a target=_blank rel=noopener href=https://github.com/orgs/pgsty/discussions aria-label=论坛><i class="fab fa-discourse"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/pgsty/pigsty aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Ruohang Feng</span></span><span class=td-footer__all_rights_reserved>保留所有权利</span><span class=ms-2><a href=/docs/about/privacy target=_blank rel=noopener>隐私政策</a></span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>